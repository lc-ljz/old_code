function c(r,t){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),n.push.apply(n,e)}return n}function s(r){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(e){j(r,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})}return r}function j(r,t,n){return t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function d(r,t){if(r==null)return{};var n=y(r,t),e,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(o=0;o<i.length;o++)e=i[o],!(t.indexOf(e)>=0)&&(!Object.prototype.propertyIsEnumerable.call(r,e)||(n[e]=r[e]))}return n}function y(r,t){if(r==null)return{};var n={},e=Object.keys(r),o,i;for(i=0;i<e.length;i++)o=e[i],!(t.indexOf(o)>=0)&&(n[o]=r[o]);return n}import{useEffect as v,useMemo as b}from"../../web_modules/react.js";import m from"../utils/event.js";import{toast as O}from"../../web_modules/react-toastify.js";import P from"../../web_modules/swr.js";function h(r,t,n){const e=P(r,t,n),{data:o,error:i}=e,u=d(e,["data","error"]),f=b(()=>!!r&&o===void 0&&!i,[r,o,i]);return v(()=>{i&&O(i.message,{position:O.POSITION.TOP_CENTER,type:O.TYPE.ERROR})},[i]),s({data:o,error:i,loading:f},u)}function w(r,t,n,e){const o=b(()=>{var l,a,p;return s(s({},e),{},{refreshInterval:t?(l=e==null?void 0:e.refreshInterval)!==null&&l!==void 0?l:15*1e3:0,dedupingInterval:(a=e==null?void 0:e.refreshInterval)!==null&&a!==void 0?a:15*1e3,errorRetryInterval:(p=e==null?void 0:e.refreshInterval)!==null&&p!==void 0?p:15*1e3})},[t,e]),i=h(r,n,o),{mutate:u}=i,f=d(i,["mutate"]);return v(()=>{t&&u()},[t,u]),v(()=>(m.on("refresh",u),()=>{m.off("refresh",u)}),[u]),s({mutate:u},f)}export default h;export{w as useRunningRequest};
