import{c as createCommonjsModule,a as commonjsGlobal}from"./common/_commonjsHelpers-4f955397.js";var numeric1_2_6=createCommonjsModule(function(module,exports){var numeric=exports;typeof commonjsGlobal!="undefined"&&(commonjsGlobal.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var r,u,i,o;for(typeof t=="undefined"&&(t=15),i=.5,r=new Date;;){for(i*=2,o=i;o>3;o-=4)e(),e(),e(),e();for(;o>0;)e(),o--;if(u=new Date,u-r>t)break}for(o=i;o>3;o-=4)e(),e(),e(),e();for(;o>0;)e(),o--;return u=new Date,1e3*(3*i-1)/(u-r)},numeric._myIndexOf=function(e){var t=this.length,r;for(r=0;r<t;++r)if(this[r]===e)return r;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function t(i){if(i===0)return"0";if(isNaN(i))return"NaN";if(i<0)return"-"+t(-i);if(isFinite(i)){var o=Math.floor(Math.log(i)/Math.log(10)),n=i/Math.pow(10,o),f=n.toPrecision(numeric.precision);return parseFloat(f)===10&&(o++,n=1,f=n.toPrecision(numeric.precision)),parseFloat(f).toString()+"e"+o.toString()}return"Infinity"}var r=[];function u(i){var o;if(typeof i=="undefined")return r.push(Array(numeric.precision+8).join(" ")),!1;if(typeof i=="string")return r.push('"'+i+'"'),!1;if(typeof i=="boolean")return r.push(i.toString()),!1;if(typeof i=="number"){var n=t(i),f=i.toPrecision(numeric.precision),a=parseFloat(i.toString()).toString(),m=[n,f,a,parseFloat(f).toString(),parseFloat(a).toString()];for(o=1;o<m.length;o++)m[o].length<n.length&&(n=m[o]);return r.push(Array(numeric.precision+8-n.length).join(" ")+n),!1}if(i===null)return r.push("null"),!1;if(typeof i=="function"){r.push(i.toString());var c=!1;for(o in i)i.hasOwnProperty(o)&&(c?r.push(`,
`):r.push(`
{`),c=!0,r.push(o),r.push(`: 
`),u(i[o]));return c&&r.push(`}
`),!0}if(i instanceof Array){if(i.length>numeric.largeArray)return r.push("...Large Array..."),!0;var c=!1;for(r.push("["),o=0;o<i.length;o++)o>0&&(r.push(","),c&&r.push(`
 `)),c=u(i[o]);return r.push("]"),!0}r.push("{");var c=!1;for(o in i)i.hasOwnProperty(o)&&(c&&r.push(`,
`),c=!0,r.push(o),r.push(`: 
`),u(i[o]));return r.push("}"),!0}return u(e),r.join("")},numeric.parseDate=function(e){function t(r){if(typeof r=="string")return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var u=[],i;for(i=0;i<r.length;i++)u[i]=t(r[i]);return u}return t(e)},numeric.parseFloat=function(e){function t(r){if(typeof r=="string")return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var u=[],i;for(i=0;i<r.length;i++)u[i]=t(r[i]);return u}return t(e)},numeric.parseCSV=function(e){var t=e.split(`
`),r,u,i=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,n=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,f=function(p){return p.substr(0,p.length-1)},a=0;for(u=0;u<t.length;u++){var m=(t[u]+",").match(o),c;if(m.length>0){for(i[a]=[],r=0;r<m.length;r++)c=f(m[r]),n.test(c)?i[a][r]=parseFloat(c):i[a][r]=c;a++}}return i},numeric.toCSV=function(e){var t=numeric.dim(e),r,u,i,o,n;for(i=t[0],t[1],n=[],r=0;r<i;r++){for(o=[],u=0;u<i;u++)o[u]=e[r][u].toString();n[r]=o.join(", ")}return n.join(`
`)+`
`},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(b){var A=b.length,B,g,D,y,F,h,j,E,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",w="";for(B=0;B<A;B+=3)g=b[B],D=b[B+1],y=b[B+2],F=g>>2,h=((g&3)<<4)+(D>>4),j=((D&15)<<2)+(y>>6),E=y&63,B+1>=A?j=E=64:B+2>=A&&(E=64),w+=M.charAt(F)+M.charAt(h)+M.charAt(j)+M.charAt(E);return w}function r(b,A,B){typeof A=="undefined"&&(A=0),typeof B=="undefined"&&(B=b.length);var g=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],D=-1,y=0;b.length;var F;for(F=A;F<B;F++)y=(D^b[F])&255,D=D>>>8^g[y];return D^-1}var u=e[0].length,i=e[0][0].length,o,n,f,a,m,c,p,l,s,v,x=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,i>>24&255,i>>16&255,i>>8&255,i&255,u>>24&255,u>>16&255,u>>8&255,u&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(v=r(x,12,29),x[29]=v>>24&255,x[30]=v>>16&255,x[31]=v>>8&255,x[32]=v&255,o=1,n=0,p=0;p<u;p++){for(p<u-1?x.push(0):x.push(1),m=3*i+1+(p===0)&255,c=3*i+1+(p===0)>>8&255,x.push(m),x.push(c),x.push(~m&255),x.push(~c&255),p===0&&x.push(0),l=0;l<i;l++)for(f=0;f<3;f++)m=e[f][p][l],m>255?m=255:m<0?m=0:m=Math.round(m),o=(o+m)%65521,n=(n+o)%65521,x.push(m);x.push(0)}return s=(n<<16)+o,x.push(s>>24&255),x.push(s>>16&255),x.push(s>>8&255),x.push(s&255),a=x.length-41,x[33]=a>>24&255,x[34]=a>>16&255,x[35]=a>>8&255,x[36]=a&255,v=r(x,37),x.push(v>>24&255),x.push(v>>16&255),x.push(v>>8&255),x.push(v&255),x.push(0),x.push(0),x.push(0),x.push(0),x.push(73),x.push(69),x.push(78),x.push(68),x.push(174),x.push(66),x.push(96),x.push(130),"data:image/png;base64,"+t(x)},numeric._dim=function(e){for(var t=[];typeof e=="object";)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t,r;return typeof e=="object"?(t=e[0],typeof t=="object"?(r=t[0],typeof r=="object"?numeric._dim(e):[e.length,t.length]):[e.length]):[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+`;
if(typeof x === "number") { var xi = x; `+e+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+e+`;
    xi = x[i-1];
    `+e+`;
}
if(i === 0) {
    xi = x[i];
    `+e+`
}
return accum;`)},numeric.mapreduce2=function(e,t){return Function("x",`var n = x.length;
var i,xi;
`+t+`;
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+e+`;
}
return accum;`)},numeric.same=function d(e,t){var r,u;if(!(e instanceof Array)||!(t instanceof Array)||(u=e.length,u!==t.length))return!1;for(r=0;r<u;r++)if(e[r]!==t[r])if(typeof e[r]=="object"){if(!d(e[r],t[r]))return!1}else return!1;return!0},numeric.rep=function(e,t,r){typeof r=="undefined"&&(r=0);var u=e[r],i=Array(u),o;if(r===e.length-1){for(o=u-2;o>=0;o-=2)i[o+1]=t,i[o]=t;return o===-1&&(i[0]=t),i}for(o=u-1;o>=0;o--)i[o]=numeric.rep(e,t,r+1);return i},numeric.dotMMsmall=function(e,t){var r,u,i,o,n,f,a,m,c,p,l;for(o=e.length,n=t.length,f=t[0].length,a=Array(o),r=o-1;r>=0;r--){for(m=Array(f),c=e[r],i=f-1;i>=0;i--){for(p=c[n-1]*t[n-1][i],u=n-2;u>=1;u-=2)l=u-1,p+=c[u]*t[u][i]+c[l]*t[l][i];u===0&&(p+=c[0]*t[0][i]),m[i]=p}a[r]=m}return a},numeric._getCol=function(e,t,r){var u=e.length,i;for(i=u-1;i>0;--i)r[i]=e[i][t],--i,r[i]=e[i][t];i===0&&(r[0]=e[0][t])},numeric.dotMMbig=function(e,t){var r=numeric._getCol,u=t.length,i=Array(u),o=e.length,n=t[0].length,f=new Array(o),a,m=numeric.dotVV,c,p;for(--u,--o,c=o;c!==-1;--c)f[c]=Array(n);for(--n,c=n;c!==-1;--c)for(r(t,c,i),p=o;p!==-1;--p)a=e[p],f[p][c]=m(a,i);return f},numeric.dotMV=function(e,t){var r=e.length;t.length;var u,i=Array(r),o=numeric.dotVV;for(u=r-1;u>=0;u--)i[u]=o(e[u],t);return i},numeric.dotVM=function(e,t){var r,u,i,o,n,f,a;for(i=e.length,o=t[0].length,n=Array(o),u=o-1;u>=0;u--){for(f=e[i-1]*t[i-1][u],r=i-2;r>=1;r-=2)a=r-1,f+=e[r]*t[r][u]+e[a]*t[a][u];r===0&&(f+=e[0]*t[0][u]),n[u]=f}return n},numeric.dotVV=function(e,t){var r,u=e.length,i,o=e[u-1]*t[u-1];for(r=u-2;r>=1;r-=2)i=r-1,o+=e[r]*t[r]+e[i]*t[i];return r===0&&(o+=e[0]*t[0]),o},numeric.dot=function(e,t){var r=numeric.dim;switch(r(e).length*1e3+r(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,r,u,i=e.length,o=Array(i),n;for(t=i-1;t>=0;t--){for(n=Array(i),r=t+2,u=i-1;u>=r;u-=2)n[u]=0,n[u-1]=0;for(u>t&&(n[u]=0),n[t]=e[t],u=t-1;u>=1;u-=2)n[u]=0,n[u-1]=0;u===0&&(n[0]=0),o[t]=n}return o},numeric.getDiag=function(d){var e=Math.min(d.length,d[0].length),t,r=Array(e);for(t=e-1;t>=1;--t)r[t]=d[t][t],--t,r[t]=d[t][t];return t===0&&(r[0]=d[0][0]),r},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,r){typeof r=="undefined"&&(r="");var u=[],i,o=/\[i\]$/,n,f="",a=!1;for(i=0;i<e.length;i++)o.test(e[i])?(n=e[i].substring(0,e[i].length-3),f=n):n=e[i],n==="ret"&&(a=!0),u.push(n);return u[e.length]="_s",u[e.length+1]="_k",u[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+f+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(a?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+e.join(",")+`,_s,_k+1);
    return ret;
}
`+r+`
for(i=_n-1;i!==-1;--i) {
    `+t+`
}
return ret;`,Function.apply(null,u)},numeric.pointwise2=function(e,t,r){typeof r=="undefined"&&(r="");var u=[],i,o=/\[i\]$/,n,f="",a=!1;for(i=0;i<e.length;i++)o.test(e[i])?(n=e[i].substring(0,e[i].length-3),f=n):n=e[i],n==="ret"&&(a=!0),u.push(n);return u[e.length]="var _n = "+f+`.length;
var i`+(a?"":", ret = Array(_n)")+`;
`+r+`
for(i=_n-1;i!==-1;--i) {
`+t+`
}
return ret;`,Function.apply(null,u)},numeric._biforeach=function d(e,t,r,u,i){if(u===r.length-1){i(e,t);return}var o,n=r[u];for(o=n-1;o>=0;o--)d(typeof e=="object"?e[o]:e,typeof t=="object"?t[o]:t,r,u+1,i)},numeric._biforeach2=function d(e,t,r,u,i){if(u===r.length-1)return i(e,t);var o,n=r[u],f=Array(n);for(o=n-1;o>=0;--o)f[o]=d(typeof e=="object"?e[o]:e,typeof t=="object"?t[o]:t,r,u+1,i);return f},numeric._foreach=function d(e,t,r,u){if(r===t.length-1){u(e);return}var i,o=t[r];for(i=o-1;i>=0;i--)d(e[i],t,r+1,u)},numeric._foreach2=function d(e,t,r,u){if(r===t.length-1)return u(e);var i,o=t[r],n=Array(o);for(i=o-1;i>=0;i--)n[i]=d(e[i],t,r+1,u);return n},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var d,e;for(d=0;d<numeric.mathfuns2.length;++d)e=numeric.mathfuns2[d],numeric.ops2[e]=e;for(d in numeric.ops2)if(numeric.ops2.hasOwnProperty(d)){e=numeric.ops2[d];var t,r,u="";numeric.myIndexOf.call(numeric.mathfuns2,d)!==-1?(u="var "+e+" = Math."+e+`;
`,t=function(i,o,n){return i+" = "+e+"("+o+","+n+")"},r=function(i,o){return i+" = "+e+"("+i+","+o+")"}):(t=function(i,o,n){return i+" = "+o+" "+e+" "+n},numeric.opseq.hasOwnProperty(d+"eq")?r=function(i,o){return i+" "+e+"= "+o}:r=function(i,o){return i+" = "+i+" "+e+" "+o}),numeric[d+"VV"]=numeric.pointwise2(["x[i]","y[i]"],t("ret[i]","x[i]","y[i]"),u),numeric[d+"SV"]=numeric.pointwise2(["x","y[i]"],t("ret[i]","x","y[i]"),u),numeric[d+"VS"]=numeric.pointwise2(["x[i]","y"],t("ret[i]","x[i]","y"),u),numeric[d]=Function(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+d+"VV, VS = numeric."+d+"VS, SV = numeric."+d+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+r("x","y")+`
}
return x;
`),numeric[e]=numeric[d],numeric[d+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),u),numeric[d+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),u),numeric[d+"eq"]=Function(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+d+"eqV, S = numeric."+d+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(d=0;d<numeric.mathfuns2.length;++d)e=numeric.mathfuns2[d],delete numeric.ops2[e];for(d=0;d<numeric.mathfuns.length;++d)e=numeric.mathfuns[d],numeric.ops1[e]=e;for(d in numeric.ops1)numeric.ops1.hasOwnProperty(d)&&(u="",e=numeric.ops1[d],numeric.myIndexOf.call(numeric.mathfuns,d)!==-1&&Math.hasOwnProperty(e)&&(u="var "+e+" = Math."+e+`;
`),numeric[d+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",u),numeric[d+"eq"]=Function("x",'if(typeof x !== "object") return '+e+`x
var i;
var V = numeric.`+d+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),numeric[d+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",u),numeric[d]=Function("x",'if(typeof x !== "object") return '+e+`(x)
var i;
var V = numeric.`+d+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(d=0;d<numeric.mathfuns.length;++d)e=numeric.mathfuns[d],delete numeric.ops1[e];for(d in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(d)&&(e=numeric.mapreducers[d],numeric[d+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[d]=Function("x","s","k",e[1]+`if(typeof x !== "object") {    xi = x;
`+e[0]+`;
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+d+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+e[0]+`;
}
return accum;
`))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return typeof e=="object"?typeof t=="object"?numeric.truncVV(e,t):numeric.truncVS(e,t):typeof t=="object"?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t=numeric.dim(e),r=Math.abs,u=t[0],i=t[1],o=numeric.clone(e),n,f,a=numeric.identity(u),m,c,p,l,s,e;for(l=0;l<i;++l){var v=-1,x=-1;for(p=l;p!==u;++p)s=r(o[p][l]),s>x&&(v=p,x=s);for(f=o[v],o[v]=o[l],o[l]=f,c=a[v],a[v]=a[l],a[l]=c,e=f[l],s=l;s!==i;++s)f[s]/=e;for(s=i-1;s!==-1;--s)c[s]/=e;for(p=u-1;p!==-1;--p)if(p!==l){for(n=o[p],m=a[p],e=n[l],s=l+1;s!==i;++s)n[s]-=f[s]*e;for(s=i-1;s>0;--s)m[s]-=c[s]*e,--s,m[s]-=c[s]*e;s===0&&(m[0]-=c[0]*e)}}return a},numeric.det=function(e){var t=numeric.dim(e);if(t.length!==2||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var r=t[0],u=1,i,o,n,f=numeric.clone(e),a,m,c,p,l;for(o=0;o<r-1;o++){for(n=o,i=o+1;i<r;i++)Math.abs(f[i][o])>Math.abs(f[n][o])&&(n=i);for(n!==o&&(p=f[n],f[n]=f[o],f[o]=p,u*=-1),a=f[o],i=o+1;i<r;i++){for(m=f[i],c=m[o]/a[o],n=o+1;n<r-1;n+=2)l=n+1,m[n]-=a[n]*c,m[l]-=a[l]*c;n!==r&&(m[n]-=a[n]*c)}if(a[o]===0)return 0;u*=a[o]}return u*f[o][o]},numeric.transpose=function(e){var t,r,u=e.length,i=e[0].length,o=Array(i),n,f,a;for(r=0;r<i;r++)o[r]=Array(u);for(t=u-1;t>=1;t-=2){for(f=e[t],n=e[t-1],r=i-1;r>=1;--r)a=o[r],a[t]=f[r],a[t-1]=n[r],--r,a=o[r],a[t]=f[r],a[t-1]=n[r];r===0&&(a=o[0],a[t]=f[0],a[t-1]=n[0])}if(t===0){for(n=e[0],r=i-1;r>=1;--r)o[r][0]=n[r],--r,o[r][0]=n[r];r===0&&(o[0][0]=n[0])}return o},numeric.negtranspose=function(e){var t,r,u=e.length,i=e[0].length,o=Array(i),n,f,a;for(r=0;r<i;r++)o[r]=Array(u);for(t=u-1;t>=1;t-=2){for(f=e[t],n=e[t-1],r=i-1;r>=1;--r)a=o[r],a[t]=-f[r],a[t-1]=-n[r],--r,a=o[r],a[t]=-f[r],a[t-1]=-n[r];r===0&&(a=o[0],a[t]=-f[0],a[t-1]=-n[0])}if(t===0){for(n=e[0],r=i-1;r>=1;--r)o[r][0]=-n[r],--r,o[r][0]=-n[r];r===0&&(o[0][0]=-n[0])}return o},numeric._random=function d(e,t){var r,u=e[t],i=Array(u),o;if(t===e.length-1){for(o=Math.random,r=u-1;r>=1;r-=2)i[r]=o(),i[r-1]=o();return r===0&&(i[0]=o()),i}for(r=u-1;r>=0;r--)i[r]=d(e,t+1);return i},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,r){if(typeof r=="undefined"&&(r=Math.max(Math.round(t-e)+1,1)),r<2)return r===1?[e]:[];var u,i=Array(r);for(r--,u=r;u>=0;u--)i[u]=(u*t+(r-u)*e)/r;return i},numeric.getBlock=function(e,t,r){var u=numeric.dim(e);function i(o,n){var f,a=t[n],m=r[n]-a,c=Array(m);if(n===u.length-1){for(f=m;f>=0;f--)c[f]=o[f+a];return c}for(f=m;f>=0;f--)c[f]=i(o[f+a],n+1);return c}return i(e,0)},numeric.setBlock=function(e,t,r,u){var i=numeric.dim(e);function o(n,f,a){var m,c=t[a],p=r[a]-c;if(a===i.length-1)for(m=p;m>=0;m--)n[m+c]=f[m];for(m=p;m>=0;m--)o(n[m+c],f[m],a+1)}return o(e,u,0),e},numeric.getRange=function(e,t,r){var u=t.length,i=r.length,o,n,f=Array(u),a,m;for(o=u-1;o!==-1;--o)for(f[o]=Array(i),a=f[o],m=e[t[o]],n=i-1;n!==-1;--n)a[n]=m[r[n]];return f},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var r=t[0],u=t[1],i,o,n,f,a;for(i=0,o=0,n=0;n<r;++n)i+=e[n][0].length;for(f=0;f<u;++f)o+=e[0][f][0].length;var m=Array(i);for(n=0;n<i;++n)m[n]=Array(o);var c=0,p,l,s,v,x;for(n=0;n<r;++n){for(p=o,f=u-1;f!==-1;--f)for(a=e[n][f],p-=a[0].length,s=a.length-1;s!==-1;--s)for(x=a[s],l=m[c+s],v=x.length-1;v!==-1;--v)l[p+v]=x[v];c+=e[n][0].length}return m},numeric.tensor=function(e,t){if(typeof e=="number"||typeof t=="number")return numeric.mul(e,t);var r=numeric.dim(e),u=numeric.dim(t);if(r.length!==1||u.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var i=r[0],o=u[0],n=Array(i),f,a,m,c;for(a=i-1;a>=0;a--){for(f=Array(o),c=e[a],m=o-1;m>=3;--m)f[m]=c*t[m],--m,f[m]=c*t[m],--m,f[m]=c*t[m],--m,f[m]=c*t[m];for(;m>=0;)f[m]=c*t[m],--m;n[a]=f}return n},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,r,u,i){if(numeric.indexOf,typeof i!="string"){var o;i="";for(o in numeric)numeric.hasOwnProperty(o)&&(e.indexOf(o)>=0||t.indexOf(o)>=0||r.indexOf(o)>=0||u.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+`;
`)}return Function(["y"],`var x = this;
if(!(y instanceof numeric.T)) { y = new numeric.T(y); }
`+i+`
if(x.y) {  if(y.y) {    return new numeric.T(`+u+`);
  }
  return new numeric.T(`+r+`);
}
if(y.y) {
  return new numeric.T(`+t+`);
}
return new numeric.T(`+e+`);
`)},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var r=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,r),t(numeric.neg(this.y),r))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),e(r)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),numeric.negtranspose(r)):new numeric.T(e(t))},numeric.Tunop=function(e,t,r){return typeof r!="string"&&(r=""),Function(`var x = this;
`+r+`
if(x.y) {  `+t+`;
}
`+e+`;
`)},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));",`var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();
return new numeric.T(numeric.log(r.x),theta.x);`),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);",`var f = numeric.norm2Squared;
return Math.sqrt(f(x.x)+f(x.y));`),numeric.T.prototype.inv=function(){var e=this;if(typeof e.y=="undefined")return new numeric.T(numeric.inv(e.x));var t=e.x.length,r,u,i,o=numeric.identity(t),n=numeric.rep([t,t],0),f=numeric.clone(e.x),a=numeric.clone(e.y),m,c,p,l,s,v,x,b,r,u,i,A,B,g,D,y,F,h;for(r=0;r<t;r++){for(g=f[r][r],D=a[r][r],A=g*g+D*D,i=r,u=r+1;u<t;u++)g=f[u][r],D=a[u][r],B=g*g+D*D,B>A&&(i=u,A=B);for(i!==r&&(h=f[r],f[r]=f[i],f[i]=h,h=a[r],a[r]=a[i],a[i]=h,h=o[r],o[r]=o[i],o[i]=h,h=n[r],n[r]=n[i],n[i]=h),m=f[r],c=a[r],s=o[r],v=n[r],g=m[r],D=c[r],u=r+1;u<t;u++)y=m[u],F=c[u],m[u]=(y*g+F*D)/A,c[u]=(F*g-y*D)/A;for(u=0;u<t;u++)y=s[u],F=v[u],s[u]=(y*g+F*D)/A,v[u]=(F*g-y*D)/A;for(u=r+1;u<t;u++){for(p=f[u],l=a[u],x=o[u],b=n[u],g=p[r],D=l[r],i=r+1;i<t;i++)y=m[i],F=c[i],p[i]-=y*g-F*D,l[i]-=F*g+y*D;for(i=0;i<t;i++)y=s[i],F=v[i],x[i]-=y*g-F*D,b[i]-=F*g+y*D}}for(r=t-1;r>0;r--)for(s=o[r],v=n[r],u=r-1;u>=0;u--)for(x=o[u],b=n[u],g=f[u][r],D=a[u][r],i=t-1;i>=0;i--)y=s[i],F=v[i],x[i]-=g*y-D*F,b[i]-=g*F+D*y;return new numeric.T(o,n)},numeric.T.prototype.get=function(e){var t=this.x,r=this.y,u=0,i,o=e.length;if(r){for(;u<o;)i=e[u],t=t[i],r=r[i],u++;return new numeric.T(t,r)}for(;u<o;)i=e[u],t=t[i],u++;return new numeric.T(t)},numeric.T.prototype.set=function(e,t){var r=this.x,u=this.y,i=0,o,n=e.length,f=t.x,a=t.y;if(n===0)return a?this.y=a:u&&(this.y=void 0),this.x=r,this;if(a){for(u||(u=numeric.rep(numeric.dim(r),0),this.y=u);i<n-1;)o=e[i],r=r[o],u=u[o],i++;return o=e[i],r[o]=f,u[o]=a,this}if(u){for(;i<n-1;)o=e[i],r=r[o],u=u[o],i++;return o=e[i],r[o]=f,f instanceof Array?u[o]=numeric.rep(numeric.dim(f),0):u[o]=0,this}for(;i<n-1;)o=e[i],r=r[o],i++;return o=e[i],r[o]=f,this},numeric.T.prototype.getRows=function(e,t){var r=t-e+1,u,i=Array(r),o,n=this.x,f=this.y;for(u=e;u<=t;u++)i[u-e]=n[u];if(f){for(o=Array(r),u=e;u<=t;u++)o[u-e]=f[u];return new numeric.T(i,o)}return new numeric.T(i)},numeric.T.prototype.setRows=function(e,t,r){var u,i=this.x,o=this.y,n=r.x,f=r.y;for(u=e;u<=t;u++)i[u]=n[u-e];if(f)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),u=e;u<=t;u++)o[u]=f[u-e];else if(o)for(u=e;u<=t;u++)o[u]=numeric.rep([n[u-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,r=this.y;return r?new numeric.T(t[e],r[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var r=this.x,u=this.y,i=t.x,o=t.y;return r[e]=i,o?(u||(u=numeric.rep(numeric.dim(r),0),this.y=u),u[e]=o):u&&(u=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var r=this.x,u=this.y,i=numeric.getBlock;return u?new numeric.T(i(r,e,t),i(u,e,t)):new numeric.T(i(r,e,t))},numeric.T.prototype.setBlock=function(e,t,r){r instanceof numeric.T||(r=new numeric.T(r));var u=this.x,i=this.y,o=numeric.setBlock,n=r.x,f=r.y;if(f)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(u,e,t,n),o(i,e,t,f),this;o(u,e,t,n),i&&o(i,e,t,numeric.rep(numeric.dim(n),0))},numeric.T.rep=function(e,t){var r=numeric.T;t instanceof r||(t=new r(t));var u=t.x,i=t.y,o=numeric.rep;return i?new r(o(e,u),o(e,i)):new r(o(e,u))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,r=e.y,u=numeric.diag;return r?new numeric.T(u(t),u(r)):new numeric.T(u(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,r=this.y;return r?new e.T(e.getDiag(t),e.getDiag(r)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),r=e[0]>=0?1:-1,u=r*numeric.norm2(e);t[0]+=u;var i=numeric.norm2(t);if(i===0)throw new Error("eig: internal error");return numeric.div(t,i)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(t.length!==2||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r=t[0],u,i,o,n,f,a=numeric.clone(e),m,c,p,l,s=numeric.identity(r),v;for(i=0;i<r-2;i++){for(n=Array(r-i-1),u=i+1;u<r;u++)n[u-i-1]=a[u][i];if(numeric.norm2(n)>0){for(f=numeric.house(n),m=numeric.getBlock(a,[i+1,i],[r-1,r-1]),c=numeric.tensor(f,numeric.dot(f,m)),u=i+1;u<r;u++)for(p=a[u],l=c[u-i-1],o=i;o<r;o++)p[o]-=2*l[o-i];for(m=numeric.getBlock(a,[0,i+1],[r-1,r-1]),c=numeric.tensor(numeric.dot(m,f),f),u=0;u<r;u++)for(p=a[u],l=c[u],o=i+1;o<r;o++)p[o]-=2*l[o-i-1];for(m=Array(r-i-1),u=i+1;u<r;u++)m[u-i-1]=s[u];for(c=numeric.tensor(f,numeric.dot(f,m)),u=i+1;u<r;u++)for(v=s[u],l=c[u-i-1],o=0;o<r;o++)v[o]-=2*l[o]}}return{H:a,Q:s}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(d,e){typeof e=="undefined"&&(e=1e4),d=numeric.clone(d),numeric.clone(d);var t=numeric.dim(d),r=t[0],u,i,o,n,f,a,m,c,p,l=numeric.identity(r),s,v,x,b,A,B,g,D,y;if(r<3)return{Q:l,B:[[0,r-1]]};var F=numeric.epsilon;for(y=0;y<e;y++){for(g=0;g<r-1;g++)if(Math.abs(d[g+1][g])<F*(Math.abs(d[g][g])+Math.abs(d[g+1][g+1]))){var h=numeric.QRFrancis(numeric.getBlock(d,[0,0],[g,g]),e),j=numeric.QRFrancis(numeric.getBlock(d,[g+1,g+1],[r-1,r-1]),e);for(x=Array(g+1),B=0;B<=g;B++)x[B]=l[B];for(b=numeric.dot(h.Q,x),B=0;B<=g;B++)l[B]=b[B];for(x=Array(r-g-1),B=g+1;B<r;B++)x[B-g-1]=l[B];for(b=numeric.dot(j.Q,x),B=g+1;B<r;B++)l[B]=b[B-g-1];return{Q:l,B:h.B.concat(numeric.add(j.B,g+1))}}if(o=d[r-2][r-2],n=d[r-2][r-1],f=d[r-1][r-2],a=d[r-1][r-1],c=o+a,m=o*a-n*f,p=numeric.getBlock(d,[0,0],[2,2]),c*c>=4*m){var E,M;E=.5*(c+Math.sqrt(c*c-4*m)),M=.5*(c-Math.sqrt(c*c-4*m)),p=numeric.add(numeric.sub(numeric.dot(p,p),numeric.mul(p,E+M)),numeric.diag(numeric.rep([3],E*M)))}else p=numeric.add(numeric.sub(numeric.dot(p,p),numeric.mul(p,c)),numeric.diag(numeric.rep([3],m)));for(u=[p[0][0],p[1][0],p[2][0]],i=numeric.house(u),x=[d[0],d[1],d[2]],b=numeric.tensor(i,numeric.dot(i,x)),B=0;B<3;B++)for(v=d[B],A=b[B],D=0;D<r;D++)v[D]-=2*A[D];for(x=numeric.getBlock(d,[0,0],[r-1,2]),b=numeric.tensor(numeric.dot(x,i),i),B=0;B<r;B++)for(v=d[B],A=b[B],D=0;D<3;D++)v[D]-=2*A[D];for(x=[l[0],l[1],l[2]],b=numeric.tensor(i,numeric.dot(i,x)),B=0;B<3;B++)for(s=l[B],A=b[B],D=0;D<r;D++)s[D]-=2*A[D];var w;for(g=0;g<r-2;g++){for(D=g;D<=g+1;D++)if(Math.abs(d[D+1][D])<F*(Math.abs(d[D][D])+Math.abs(d[D+1][D+1]))){var h=numeric.QRFrancis(numeric.getBlock(d,[0,0],[D,D]),e),j=numeric.QRFrancis(numeric.getBlock(d,[D+1,D+1],[r-1,r-1]),e);for(x=Array(D+1),B=0;B<=D;B++)x[B]=l[B];for(b=numeric.dot(h.Q,x),B=0;B<=D;B++)l[B]=b[B];for(x=Array(r-D-1),B=D+1;B<r;B++)x[B-D-1]=l[B];for(b=numeric.dot(j.Q,x),B=D+1;B<r;B++)l[B]=b[B-D-1];return{Q:l,B:h.B.concat(numeric.add(j.B,D+1))}}for(w=Math.min(r-1,g+3),u=Array(w-g),B=g+1;B<=w;B++)u[B-g-1]=d[B][g];for(i=numeric.house(u),x=numeric.getBlock(d,[g+1,g],[w,r-1]),b=numeric.tensor(i,numeric.dot(i,x)),B=g+1;B<=w;B++)for(v=d[B],A=b[B-g-1],D=g;D<r;D++)v[D]-=2*A[D-g];for(x=numeric.getBlock(d,[0,g+1],[r-1,w]),b=numeric.tensor(numeric.dot(x,i),i),B=0;B<r;B++)for(v=d[B],A=b[B],D=g+1;D<=w;D++)v[D]-=2*A[D-g-1];for(x=Array(w-g),B=g+1;B<=w;B++)x[B-g-1]=l[B];for(b=numeric.tensor(i,numeric.dot(i,x)),B=g+1;B<=w;B++)for(s=l[B],A=b[B-g-1],D=0;D<r;D++)s[D]-=2*A[D]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var r=numeric.toUpperHessenberg(e),u=numeric.QRFrancis(r.H,t),i=numeric.T,o=e.length,n,f,a=u.B,m=numeric.dot(u.Q,numeric.dot(r.H,numeric.transpose(u.Q))),c=new i(numeric.dot(u.Q,r.Q)),p,l=a.length,s,v,x,b,A,B,g,D,y,F,h,j,E,M,w=Math.sqrt;for(f=0;f<l;f++)if(n=a[f][0],n!==a[f][1]){if(s=n+1,v=m[n][n],x=m[n][s],b=m[s][n],A=m[s][s],x===0&&b===0)continue;B=-v-A,g=v*A-x*b,D=B*B-4*g,D>=0?(B<0?y=-.5*(B-w(D)):y=-.5*(B+w(D)),E=(v-y)*(v-y)+x*x,M=b*b+(A-y)*(A-y),E>M?(E=w(E),h=(v-y)/E,j=x/E):(M=w(M),h=b/M,j=(A-y)/M),p=new i([[j,-h],[h,j]]),c.setRows(n,s,p.dot(c.getRows(n,s)))):(y=-.5*B,F=.5*w(-D),E=(v-y)*(v-y)+x*x,M=b*b+(A-y)*(A-y),E>M?(E=w(E+F*F),h=(v-y)/E,j=x/E,y=0,F/=E):(M=w(M+F*F),h=b/M,j=(A-y)/M,y=F/M,F=0),p=new i([[j,-h],[h,j]],[[y,F],[F,-y]]),c.setRows(n,s,p.dot(c.getRows(n,s))))}var _=c.dot(e).dot(c.transjugate()),o=e.length,C=numeric.T.identity(o);for(s=0;s<o;s++)if(s>0)for(f=s-1;f>=0;f--){var V=_.get([f,f]),L=_.get([s,s]);if(numeric.neq(V.x,L.x)||numeric.neq(V.y,L.y))y=_.getRow(f).getBlock([f],[s-1]),F=C.getRow(s).getBlock([f],[s-1]),C.set([s,f],_.get([f,s]).neg().sub(y.dot(F)).div(V.sub(L)));else{C.setRow(s,C.getRow(f));continue}}for(s=0;s<o;s++)y=C.getRow(s),C.setRow(s,y.div(y.norm2()));return C=C.transpose(),C=c.transjugate().dot(C),{lambda:_.getDiag(),E:C}},numeric.ccsSparse=function(e){var t=e.length,r,u,i,o,n=[];for(i=t-1;i!==-1;--i){u=e[i];for(o in u){for(o=parseInt(o);o>=n.length;)n[n.length]=0;u[o]!==0&&n[o]++}}var r=n.length,f=Array(r+1);for(f[0]=0,i=0;i<r;++i)f[i+1]=f[i]+n[i];var a=Array(f[r]),m=Array(f[r]);for(i=t-1;i!==-1;--i){u=e[i];for(o in u)u[o]!==0&&(n[o]--,a[f[o]+n[o]]=i,m[f[o]+n[o]]=u[o])}return[f,a,m]},numeric.ccsFull=function(e){var t=e[0],r=e[1],u=e[2],i=numeric.ccsDim(e),o=i[0],n=i[1],f,a,m,c,p=numeric.rep([o,n],0);for(f=0;f<n;f++)for(m=t[f],c=t[f+1],a=m;a<c;++a)p[r[a]][f]=u[a];return p},numeric.ccsTSolve=function(e,t,r,u,i){var o=e[0],n=e[1],f=e[2],a=o.length-1,m=Math.max,c=0;typeof u=="undefined"&&(r=numeric.rep([a],0)),typeof u=="undefined"&&(u=numeric.linspace(0,r.length-1)),typeof i=="undefined"&&(i=[]);function p(g){var D;if(r[g]===0){for(r[g]=1,D=o[g];D<o[g+1];++D)p(n[D]);i[c]=g,++c}}var l,s,v,x,b,A,B;for(l=u.length-1;l!==-1;--l)p(u[l]);for(i.length=c,l=i.length-1;l!==-1;--l)r[i[l]]=0;for(l=u.length-1;l!==-1;--l)s=u[l],r[s]=t[s];for(l=i.length-1;l!==-1;--l){for(s=i[l],v=o[s],x=m(o[s+1],v),b=v;b!==x;++b)if(n[b]===s){r[s]/=f[b];break}for(B=r[s],b=v;b!==x;++b)A=n[b],A!==s&&(r[A]-=B*f[b])}return r},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,r,u,i,o){var n=0,f,a=i.length,m=this.k,c=this.k1,p=this.j,l,s;if(u[e]===0)for(u[e]=1,p[0]=e,m[0]=l=t[e],c[0]=s=t[e+1];;)if(l>=s){if(i[a]=p[n],n===0)return;++a,--n,l=m[n],s=c[n]}else f=o[r[l]],u[f]===0?(u[f]=1,m[n]=l,++n,p[n]=f,l=t[f],c[n]=s=t[f+1]):++l},numeric.ccsLPSolve=function(e,t,r,u,i,o,n){var f=e[0],a=e[1],m=e[2];f.length-1;var c=t[0],p=t[1],l=t[2],s,v,x,b,A,B,g,D,y;for(v=c[i],x=c[i+1],u.length=0,s=v;s<x;++s)n.dfs(o[p[s]],f,a,r,u,o);for(s=u.length-1;s!==-1;--s)r[u[s]]=0;for(s=v;s!==x;++s)b=o[p[s]],r[b]=l[s];for(s=u.length-1;s!==-1;--s){for(b=u[s],A=f[b],B=f[b+1],g=A;g<B;++g)if(o[a[g]]===b){r[b]/=m[g];break}for(y=r[b],g=A;g<B;++g)D=o[a[g]],D!==b&&(r[D]-=y*m[g])}return r},numeric.ccsLUP1=function(e,t){var r=e[0].length-1,u=[numeric.rep([r+1],0),[],[]],i=[numeric.rep([r+1],0),[],[]],o=u[0],n=u[1],f=u[2],a=i[0],m=i[1],c=i[2],p=numeric.rep([r],0),l=numeric.rep([r],0),s,v,x,b,A,B,g,D=numeric.ccsLPSolve,y=Math.abs,F=numeric.linspace(0,r-1),h=numeric.linspace(0,r-1),j=new numeric.ccsDFS(r);for(typeof t=="undefined"&&(t=1),s=0;s<r;++s){for(D(u,e,p,l,s,h,j),b=-1,A=-1,v=l.length-1;v!==-1;--v)x=l[v],!(x<=s)&&(B=y(p[x]),B>b&&(A=x,b=B));for(y(p[s])<t*b&&(v=F[s],b=F[A],F[s]=b,h[b]=s,F[A]=v,h[v]=A,b=p[s],p[s]=p[A],p[A]=b),b=o[s],A=a[s],g=p[s],n[b]=F[s],f[b]=1,++b,v=l.length-1;v!==-1;--v)x=l[v],B=p[x],l[v]=0,p[x]=0,x<=s?(m[A]=x,c[A]=B,++A):(n[b]=F[x],f[b]=B/g,++b);o[s+1]=b,a[s+1]=A}for(v=n.length-1;v!==-1;--v)n[v]=h[n[v]];return{L:u,U:i,P:F,Pinv:h}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,r,u,i,o,n){var f=0,a,m=i.length,c=this.k,p=this.k1,l=this.j,s,v;if(u[e]===0)for(u[e]=1,l[0]=e,c[0]=s=t[o[e]],p[0]=v=t[o[e]+1];;){if(isNaN(s))throw new Error("Ow!");if(s>=v){if(i[m]=o[l[f]],f===0)return;++m,--f,s=c[f],v=p[f]}else a=r[s],u[a]===0?(u[a]=1,c[f]=s,++f,l[f]=a,a=o[a],s=t[a],p[f]=v=t[a+1]):++s}},numeric.ccsLPSolve0=function(e,t,r,u,i,o,n,f){var a=e[0],m=e[1],c=e[2];a.length-1;var p=t[0],l=t[1],s=t[2],v,x,b,A,B,g,D,y,F;for(x=p[i],b=p[i+1],u.length=0,v=x;v<b;++v)f.dfs(l[v],a,m,r,u,o,n);for(v=u.length-1;v!==-1;--v)A=u[v],r[n[A]]=0;for(v=x;v!==b;++v)A=l[v],r[A]=s[v];for(v=u.length-1;v!==-1;--v){for(A=u[v],y=n[A],B=a[A],g=a[A+1],D=B;D<g;++D)if(m[D]===y){r[y]/=c[D];break}for(F=r[y],D=B;D<g;++D)r[m[D]]-=F*c[D];r[y]=F}},numeric.ccsLUP0=function(e,t){var r=e[0].length-1,u=[numeric.rep([r+1],0),[],[]],i=[numeric.rep([r+1],0),[],[]],o=u[0],n=u[1],f=u[2],a=i[0],m=i[1],c=i[2],p=numeric.rep([r],0),l=numeric.rep([r],0),s,v,x,b,A,B,g,D=numeric.ccsLPSolve0,y=Math.abs,F=numeric.linspace(0,r-1),h=numeric.linspace(0,r-1),j=new numeric.ccsDFS0(r);for(typeof t=="undefined"&&(t=1),s=0;s<r;++s){for(D(u,e,p,l,s,h,F,j),b=-1,A=-1,v=l.length-1;v!==-1;--v)x=l[v],!(x<=s)&&(B=y(p[F[x]]),B>b&&(A=x,b=B));for(y(p[F[s]])<t*b&&(v=F[s],b=F[A],F[s]=b,h[b]=s,F[A]=v,h[v]=A),b=o[s],A=a[s],g=p[F[s]],n[b]=F[s],f[b]=1,++b,v=l.length-1;v!==-1;--v)x=l[v],B=p[F[x]],l[v]=0,p[F[x]]=0,x<=s?(m[A]=x,c[A]=B,++A):(n[b]=F[x],f[b]=B/g,++b);o[s+1]=b,a[s+1]=A}for(v=n.length-1;v!==-1;--v)n[v]=h[n[v]];return{L:u,U:i,P:F,Pinv:h}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,r){var u=numeric.ccsDim(e),i=u[0],o=u[1];typeof t=="undefined"?t=numeric.linspace(0,i-1):typeof t=="number"&&(t=[t]),typeof r=="undefined"?r=numeric.linspace(0,o-1):typeof r=="number"&&(r=[r]);var n,f=t.length,a,m=r.length,c,p,l,s=numeric.rep([o],0),v=[],x=[],b=[s,v,x],A=e[0],B=e[1],g=e[2],D=numeric.rep([i],0),y=0,F=numeric.rep([i],0);for(a=0;a<m;++a){p=r[a];var h=A[p],j=A[p+1];for(n=h;n<j;++n)c=B[n],F[c]=1,D[c]=g[n];for(n=0;n<f;++n)l=t[n],F[l]&&(v[y]=n,x[y]=D[t[n]],++y);for(n=h;n<j;++n)c=B[n],F[c]=0;s[a+1]=y}return b},numeric.ccsDot=function(e,t){var r=e[0],u=e[1],i=e[2],o=t[0],n=t[1],f=t[2],a=numeric.ccsDim(e),m=numeric.ccsDim(t),c=a[0];a[1];var p=m[1],l=numeric.rep([c],0),s=numeric.rep([c],0),v=Array(c),x=numeric.rep([p],0),b=[],A=[],B=[x,b,A],g,D,y,F,h,j,E,M,w,_,C;for(y=0;y!==p;++y){for(F=o[y],h=o[y+1],w=0,D=F;D<h;++D)for(_=n[D],C=f[D],j=r[_],E=r[_+1],g=j;g<E;++g)M=u[g],s[M]===0&&(v[w]=M,s[M]=1,w=w+1),l[M]=l[M]+i[g]*C;for(F=x[y],h=F+w,x[y+1]=h,D=w-1;D!==-1;--D)C=F+D,g=v[D],b[C]=g,A[C]=l[g],s[g]=0,l[g]=0;x[y+1]=x[y]+w}return B},numeric.ccsLUPSolve=function(e,t){var r=e.L,u=e.U;e.P;var i=t[0],o=!1;typeof i!="object"&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],i=t[0],o=!0);var n=t[1],f=t[2],a=r[0].length-1,m=i.length-1,c=numeric.rep([a],0),p=Array(a),l=numeric.rep([a],0),s=Array(a),v=numeric.rep([m+1],0),x=[],b=[],A=numeric.ccsTSolve,B,g,D,y,F,h,j=0;for(B=0;B<m;++B){for(F=0,D=i[B],y=i[B+1],g=D;g<y;++g)h=e.Pinv[n[g]],s[F]=h,l[h]=f[g],++F;for(s.length=F,A(r,l,c,s,p),g=s.length-1;g!==-1;--g)l[s[g]]=0;if(A(u,c,l,p,s),o)return l;for(g=p.length-1;g!==-1;--g)c[p[g]]=0;for(g=s.length-1;g!==-1;--g)h=s[g],x[j]=h,b[j]=l[h],l[h]=0,++j;v[B+1]=j}return[v,x,b]},numeric.ccsbinop=function(e,t){return typeof t=="undefined"&&(t=""),Function("X","Y",`var Xi = X[0], Xj = X[1], Xv = X[2];
var Yi = Y[0], Yj = Y[1], Yv = Y[2];
var n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;
var Zi = numeric.rep([n+1],0), Zj = [], Zv = [];
var x = numeric.rep([m],0),y = numeric.rep([m],0);
var xk,yk,zk;
var i,j,j0,j1,k,p=0;
`+t+`for(i=0;i<n;++i) {
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Xj[j];
    x[k] = 1;
    Zj[p] = k;
    ++p;
  }
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Yj[j];
    y[k] = Yv[j];
    if(x[k] === 0) {
      Zj[p] = k;
      ++p;
    }
  }
  Zi[i+1] = p;
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];
  j0 = Zi[i]; j1 = Zi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Zj[j];
    xk = x[k];
    yk = y[k];
`+e+`
    Zv[j] = zk;
  }
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;
}
return [Zi,Zj,Zv];`)},function(){var k,A,B,C;for(k in numeric.ops2)isFinite(eval("1"+numeric.ops2[k]+"0"))?A="[Y[0],Y[1],numeric."+k+"(X,Y[2])]":A="NaN",isFinite(eval("0"+numeric.ops2[k]+"1"))?B="[X[0],X[1],numeric."+k+"(X[2],Y)]":B="NaN",isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?C="numeric.ccs"+k+"MM(X,Y)":C="NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+`;
if(typeof Y === "number") return `+B+`;
return `+C+`;
`)}(),numeric.ccsScatter=function(e){var t=e[0],r=e[1],u=e[2],i=numeric.sup(r)+1,o=t.length,n=numeric.rep([i],0),f=Array(o),a=Array(o),m=numeric.rep([i],0),c;for(c=0;c<o;++c)m[r[c]]++;for(c=0;c<i;++c)n[c+1]=n[c]+m[c];var p=n.slice(0),l,s;for(c=0;c<o;++c)s=r[c],l=p[s],f[l]=t[c],a[l]=u[c],p[s]=p[s]+1;return[n,f,a]},numeric.ccsGather=function(e){var t=e[0],r=e[1],u=e[2],i=t.length-1,o=r.length,n=Array(o),f=Array(o),a=Array(o),m,c,p,l,s;for(s=0,m=0;m<i;++m)for(p=t[m],l=t[m+1],c=p;c!==l;++c)f[s]=m,n[s]=r[c],a[s]=u[c],++s;return[n,f,a]},numeric.sdim=function d(e,t,r){if(typeof t=="undefined"&&(t=[]),typeof e!="object")return t;typeof r=="undefined"&&(r=0),r in t||(t[r]=0),e.length>t[r]&&(t[r]=e.length);var u;for(u in e)e.hasOwnProperty(u)&&d(e[u],t,r+1);return t},numeric.sclone=function d(e,t,r){typeof t=="undefined"&&(t=0),typeof r=="undefined"&&(r=numeric.sdim(e).length);var u,i=Array(e.length);if(t===r-1){for(u in e)e.hasOwnProperty(u)&&(i[u]=e[u]);return i}for(u in e)e.hasOwnProperty(u)&&(i[u]=d(e[u],t+1,r));return i},numeric.sdiag=function(e){var t=e.length,r,u=Array(t),i;for(r=t-1;r>=1;r-=2)i=r-1,u[r]=[],u[r][r]=e[r],u[i]=[],u[i][i]=e[i];return r===0&&(u[0]=[],u[0][0]=e[r]),u},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t=[];e.length;var r,u,i;for(r in e)if(!!e.hasOwnProperty(r)){i=e[r];for(u in i)!i.hasOwnProperty(u)||(typeof t[u]!="object"&&(t[u]=[]),t[u][r]=i[u])}return t},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var r=e.length;t.length;var u=numeric.stranspose(t),i=u.length,o,n,f,a,m,c,p=Array(r),l;for(f=r-1;f>=0;f--){for(l=[],o=e[f],m=i-1;m>=0;m--){c=0,n=u[m];for(a in o)!o.hasOwnProperty(a)||a in n&&(c+=o[a]*n[a]);c&&(l[m]=c)}p[f]=l}return p},numeric.sdotMV=function(e,t){var r=e.length,u,i,o,n=Array(r),f;for(i=r-1;i>=0;i--){u=e[i],f=0;for(o in u)!u.hasOwnProperty(o)||t[o]&&(f+=u[o]*t[o]);f&&(n[i]=f)}return n},numeric.sdotVM=function(e,t){var r,u,i,o,n=[];for(r in e)if(!!e.hasOwnProperty(r)){i=t[r],o=e[r];for(u in i)!i.hasOwnProperty(u)||(n[u]||(n[u]=0),n[u]+=o*i[u])}return n},numeric.sdotVV=function(e,t){var r,u=0;for(r in e)e[r]&&t[r]&&(u+=e[r]*t[r]);return u},numeric.sdot=function(e,t){var r=numeric.sdim(e).length,u=numeric.sdim(t).length,i=r*1e3+u;switch(i){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+u)}},numeric.sscatter=function(e){var t=e[0].length,r,u,i,o=e.length,n=[],f;for(u=t-1;u>=0;--u)if(!!e[o-1][u]){for(f=n,i=0;i<o-2;i++)r=e[i][u],f[r]||(f[r]=[]),f=f[r];f[e[i][u]]=e[i+1][u]}return n},numeric.sgather=function d(e,t,r){typeof t=="undefined"&&(t=[]),typeof r=="undefined"&&(r=[]);var u,i,o;u=r.length;for(i in e)if(e.hasOwnProperty(i))if(r[u]=parseInt(i),o=e[i],typeof o=="number"){if(o){if(t.length===0)for(i=u+1;i>=0;--i)t[i]=[];for(i=u;i>=0;--i)t[i].push(r[i]);t[u+1].push(o)}}else d(o,t,r);return r.length>u&&r.pop(),t},numeric.cLU=function(e){var t=e[0],r=e[1],u=e[2],i=t.length,o=0,n,f,a,m,c,p;for(n=0;n<i;n++)t[n]>o&&(o=t[n]);o++;var l=Array(o),s=Array(o),v=numeric.rep([o],Infinity),x=numeric.rep([o],-Infinity),b,A,B;for(a=0;a<i;a++)n=t[a],f=r[a],f<v[n]&&(v[n]=f),f>x[n]&&(x[n]=f);for(n=0;n<o-1;n++)x[n]>x[n+1]&&(x[n+1]=x[n]);for(n=o-1;n>=1;n--)v[n]<v[n-1]&&(v[n-1]=v[n]);var g=0,D=0;for(n=0;n<o;n++)s[n]=numeric.rep([x[n]-v[n]+1],0),l[n]=numeric.rep([n-v[n]],0),g+=n-v[n]+1,D+=x[n]-n+1;for(a=0;a<i;a++)n=t[a],s[n][r[a]-v[n]]=u[a];for(n=0;n<o-1;n++)for(m=n-v[n],b=s[n],f=n+1;v[f]<=n&&f<o;f++)if(c=n-v[f],p=x[n]-n,A=s[f],B=A[c]/b[m],B){for(a=1;a<=p;a++)A[a+c]-=B*b[a+m];l[f][n-v[f]]=B}var b=[],A=[],y=[],F=[],h=[],j=[],i,E,M;for(i=0,E=0,n=0;n<o;n++){for(m=v[n],c=x[n],M=s[n],f=n;f<=c;f++)M[f-m]&&(b[i]=n,A[i]=f,y[i]=M[f-m],i++);for(M=l[n],f=m;f<n;f++)M[f-m]&&(F[E]=n,h[E]=f,j[E]=M[f-m],E++);F[E]=n,h[E]=n,j[E]=1,E++}return{U:[b,A,y],L:[F,h,j]}},numeric.cLUsolve=function(e,t){var r=e.L,u=e.U,i=numeric.clone(t),o=r[0],n=r[1],f=r[2],a=u[0],m=u[1],c=u[2],p=a.length;o.length;var l=i.length,s,v;for(v=0,s=0;s<l;s++){for(;n[v]<s;)i[s]-=f[v]*i[n[v]],v++;v++}for(v=p-1,s=l-1;s>=0;s--){for(;m[v]>s;)i[s]-=c[v]*i[m[v]],v--;i[s]/=c[v],v--}return i},numeric.cgrid=function(e,t){typeof e=="number"&&(e=[e,e]);var r=numeric.rep(e,-1),u,i,o;if(typeof t!="function")switch(t){case"L":t=function(n,f){return n>=e[0]/2||f<e[1]/2};break;default:t=function(n,f){return!0};break}for(o=0,u=1;u<e[0]-1;u++)for(i=1;i<e[1]-1;i++)t(u,i)&&(r[u][i]=o,o++);return r},numeric.cdelsq=function(e){var t=[[-1,0],[0,-1],[0,1],[1,0]],r=numeric.dim(e),u=r[0],i=r[1],o,n,f,a,m,c=[],p=[],l=[];for(o=1;o<u-1;o++)for(n=1;n<i-1;n++)if(!(e[o][n]<0)){for(f=0;f<4;f++)a=o+t[f][0],m=n+t[f][1],!(e[a][m]<0)&&(c.push(e[o][n]),p.push(e[a][m]),l.push(-1));c.push(e[o][n]),p.push(e[o][n]),l.push(4)}return[c,p,l]},numeric.cdotMV=function(e,t){var r,u=e[0],i=e[1],o=e[2],n,f=u.length,a;for(a=0,n=0;n<f;n++)u[n]>a&&(a=u[n]);for(a++,r=numeric.rep([a],0),n=0;n<f;n++)r[u[n]]+=o[n]*t[i[n]];return r},numeric.Spline=function(e,t,r,u,i){this.x=e,this.yl=t,this.yr=r,this.kl=u,this.kr=i},numeric.Spline.prototype._at=function(e,t){var r=this.x,u=this.yl,i=this.yr,o=this.kl,n=this.kr,e,f,a,m,c=numeric.add,p=numeric.sub,l=numeric.mul;f=p(l(o[t],r[t+1]-r[t]),p(i[t+1],u[t])),a=c(l(n[t+1],r[t]-r[t+1]),p(i[t+1],u[t])),m=(e-r[t])/(r[t+1]-r[t]);var s=m*(1-m);return c(c(c(l(1-m,u[t]),l(m,i[t+1])),l(f,s*(1-m))),l(a,s*m))},numeric.Spline.prototype.at=function(e){if(typeof e=="number"){var t=this.x,n=t.length,r,u,i,o=Math.floor;for(r=0,u=n-1;u-r>1;)i=o((r+u)/2),t[i]<=e?r=i:u=i;return this._at(e,r)}var n=e.length,f,a=Array(n);for(f=n-1;f!==-1;--f)a[f]=this.at(e[f]);return a},numeric.Spline.prototype.diff=function(){var e=this.x,t=this.yl,r=this.yr,u=this.kl,i=this.kr,o=t.length,n,f,a,m=u,c=i,p=Array(o),l=Array(o),s=numeric.add,v=numeric.mul,x=numeric.div,b=numeric.sub;for(n=o-1;n!==-1;--n)f=e[n+1]-e[n],a=b(r[n+1],t[n]),p[n]=x(s(v(a,6),v(u[n],-4*f),v(i[n+1],-2*f)),f*f),l[n+1]=x(s(v(a,-6),v(u[n],2*f),v(i[n+1],4*f)),f*f);return new numeric.Spline(e,m,c,p,l)},numeric.Spline.prototype.roots=function(){function e(q){return q*q}var t=[],r=this.x,u=this.yl,i=this.yr,o=this.kl,n=this.kr;typeof u[0]=="number"&&(u=[u],i=[i],o=[o],n=[n]);var f=u.length,a=r.length-1,m,c,p,l,s,v,x,t=Array(f),b,A,B,g,D,y,F,h,j,E,M,w,_,C,V,L,S=Math.sqrt;for(m=0;m!==f;++m){for(l=u[m],s=i[m],v=o[m],x=n[m],b=[],c=0;c!==a;c++){for(c>0&&s[c]*l[c]<0&&b.push(r[c]),j=r[c+1]-r[c],r[c],g=l[c],D=s[c+1],A=v[c]/j,B=x[c+1]/j,h=e(A-B+3*(g-D))+12*B*g,y=B+3*g+2*A-3*D,F=3*(B+A+2*(g-D)),h<=0?(M=y/F,M>r[c]&&M<r[c+1]?E=[r[c],M,r[c+1]]:E=[r[c],r[c+1]]):(M=(y-S(h))/F,w=(y+S(h))/F,E=[r[c]],M>r[c]&&M<r[c+1]&&E.push(M),w>r[c]&&w<r[c+1]&&E.push(w),E.push(r[c+1])),C=E[0],M=this._at(C,c),p=0;p<E.length-1;p++){if(V=E[p+1],w=this._at(V,c),M===0){b.push(C),C=V,M=w;continue}if(w===0||M*w>0){C=V,M=w;continue}for(var k=0;L=(M*V-w*C)/(M-w),!(L<=C||L>=V);)if(_=this._at(L,c),_*w>0)V=L,w=_,k===-1&&(M*=.5),k=-1;else if(_*M>0)C=L,M=_,k===1&&(w*=.5),k=1;else break;b.push(L),C=E[p+1],M=this._at(C,c)}w===0&&b.push(V)}t[m]=b}return typeof this.yl[0]=="number"?t[0]:t},numeric.spline=function(e,t,r,u){var i=e.length,o=[],n=[],f=[],a,m=numeric.sub,c=numeric.mul,p=numeric.add;for(a=i-2;a>=0;a--)n[a]=e[a+1]-e[a],f[a]=m(t[a+1],t[a]);(typeof r=="string"||typeof u=="string")&&(r=u="periodic");var l=[[],[],[]];switch(typeof r){case"undefined":o[0]=c(3/(n[0]*n[0]),f[0]),l[0].push(0,0),l[1].push(0,1),l[2].push(2/n[0],1/n[0]);break;case"string":o[0]=p(c(3/(n[i-2]*n[i-2]),f[i-2]),c(3/(n[0]*n[0]),f[0])),l[0].push(0,0,0),l[1].push(i-2,0,1),l[2].push(1/n[i-2],2/n[i-2]+2/n[0],1/n[0]);break;default:o[0]=r,l[0].push(0),l[1].push(0),l[2].push(1);break}for(a=1;a<i-1;a++)o[a]=p(c(3/(n[a-1]*n[a-1]),f[a-1]),c(3/(n[a]*n[a]),f[a])),l[0].push(a,a,a),l[1].push(a-1,a,a+1),l[2].push(1/n[a-1],2/n[a-1]+2/n[a],1/n[a]);switch(typeof u){case"undefined":o[i-1]=c(3/(n[i-2]*n[i-2]),f[i-2]),l[0].push(i-1,i-1),l[1].push(i-2,i-1),l[2].push(1/n[i-2],2/n[i-2]);break;case"string":l[1][l[1].length-1]=0;break;default:o[i-1]=u,l[0].push(i-1),l[1].push(i-1),l[2].push(1);break}typeof o[0]!="number"?o=numeric.transpose(o):o=[o];var s=Array(o.length);if(typeof r=="string")for(a=s.length-1;a!==-1;--a)s[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(l)),o[a]),s[a][i-1]=s[a][0];else for(a=s.length-1;a!==-1;--a)s[a]=numeric.cLUsolve(numeric.cLU(l),o[a]);return typeof t[0]=="number"?s=s[0]:s=numeric.transpose(s),new numeric.Spline(e,t,t,s,s)},numeric.fftpow2=function d(e,t){var r=e.length;if(r!==1){var u=Math.cos,i=Math.sin,o,n,f=Array(r/2),a=Array(r/2),m=Array(r/2),c=Array(r/2);for(n=r/2,o=r-1;o!==-1;--o)--n,m[n]=e[o],c[n]=t[o],--o,f[n]=e[o],a[n]=t[o];d(f,a),d(m,c),n=r/2;var p,l=-6.283185307179586/r,s,v;for(o=r-1;o!==-1;--o)--n,n===-1&&(n=r/2-1),p=l*o,s=u(p),v=i(p),e[o]=f[n]+s*m[n]-v*c[n],t[o]=a[n]+s*c[n]+v*m[n]}},numeric._ifftpow2=function d(e,t){var r=e.length;if(r!==1){var u=Math.cos,i=Math.sin,o,n,f=Array(r/2),a=Array(r/2),m=Array(r/2),c=Array(r/2);for(n=r/2,o=r-1;o!==-1;--o)--n,m[n]=e[o],c[n]=t[o],--o,f[n]=e[o],a[n]=t[o];d(f,a),d(m,c),n=r/2;var p,l=6.283185307179586/r,s,v;for(o=r-1;o!==-1;--o)--n,n===-1&&(n=r/2-1),p=l*o,s=u(p),v=i(p),e[o]=f[n]+s*m[n]-v*c[n],t[o]=a[n]+s*c[n]+v*m[n]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,r,u){numeric.fftpow2(e,t),numeric.fftpow2(r,u);var i,o=e.length,n,f,a,m;for(i=o-1;i!==-1;--i)n=e[i],a=t[i],f=r[i],m=u[i],e[i]=n*f-a*m,t[i]=n*m+a*f;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e=this.x,t=this.y,r=e.length,u=Math.log,i=u(2),o=Math.ceil(u(2*r-1)/i),n=Math.pow(2,o),f=numeric.rep([n],0),a=numeric.rep([n],0),m=Math.cos,c=Math.sin,p,l=-3.141592653589793/r,s,v=numeric.rep([n],0),x=numeric.rep([n],0);for(p=0;p<r;p++)v[p]=e[p];if(typeof t!="undefined")for(p=0;p<r;p++)x[p]=t[p];for(f[0]=1,p=1;p<=n/2;p++)s=l*p*p,f[p]=m(s),a[p]=c(s),f[n-p]=m(s),a[n-p]=c(s);var b=new numeric.T(v,x),A=new numeric.T(f,a);return b=b.mul(A),numeric.convpow2(b.x,b.y,numeric.clone(A.x),numeric.neg(A.y)),b=b.mul(A),b.x.length=r,b.y.length=r,b},numeric.T.prototype.ifft=function(){var e=this.x,t=this.y,r=e.length,u=Math.log,i=u(2),o=Math.ceil(u(2*r-1)/i),n=Math.pow(2,o),f=numeric.rep([n],0),a=numeric.rep([n],0),m=Math.cos,c=Math.sin,p,l=3.141592653589793/r,s,v=numeric.rep([n],0),x=numeric.rep([n],0);for(p=0;p<r;p++)v[p]=e[p];if(typeof t!="undefined")for(p=0;p<r;p++)x[p]=t[p];for(f[0]=1,p=1;p<=n/2;p++)s=l*p*p,f[p]=m(s),a[p]=c(s),f[n-p]=m(s),a[n-p]=c(s);var b=new numeric.T(v,x),A=new numeric.T(f,a);return b=b.mul(A),numeric.convpow2(b.x,b.y,numeric.clone(A.x),numeric.neg(A.y)),b=b.mul(A),b.x.length=r,b.y.length=r,b.div(r)},numeric.gradient=function(e,t){var r=t.length,u=e(t);if(isNaN(u))throw new Error("gradient: f(x) is a NaN!");var i=Math.max,o,n=numeric.clone(t),f,a,m=Array(r);numeric.div,numeric.sub;var c,i=Math.max,p=.001,l=Math.abs,s=Math.min,v,x,b,A=0,B,g,D;for(o=0;o<r;o++)for(var y=i(1e-6*u,1e-8);;){if(++A,A>20)throw new Error("Numerical gradient fails");if(n[o]=t[o]+y,f=e(n),n[o]=t[o]-y,a=e(n),n[o]=t[o],isNaN(f)||isNaN(a)){y/=16;continue}if(m[o]=(f-a)/(2*y),v=t[o]-y,x=t[o],b=t[o]+y,B=(f-u)/y,g=(u-a)/y,D=i(l(m[o]),l(u),l(f),l(a),l(v),l(x),l(b),1e-8),c=s(i(l(B-m[o]),l(g-m[o]),l(B-g))/D,y/D),c>p)y/=16;else break}return m},numeric.uncmin=function(e,t,r,u,i,o,n){var f=numeric.gradient;typeof n=="undefined"&&(n={}),typeof r=="undefined"&&(r=1e-8),typeof u=="undefined"&&(u=function(W){return f(e,W)}),typeof i=="undefined"&&(i=1e3),t=numeric.clone(t);var a=t.length,m=e(t),c,p;if(isNaN(m))throw new Error("uncmin: f(x0) is a NaN!");var l=Math.max,s=numeric.norm2;r=l(r,numeric.epsilon);var v,x,b,A=n.Hinv||numeric.identity(a),B=numeric.dot;numeric.inv;var g=numeric.sub,D=numeric.add,y=numeric.tensor,F=numeric.div,h=numeric.mul,j=numeric.all,E=numeric.isFinite,M=numeric.neg,w=0,_,C,V,L,S,k,q,Q="";for(x=u(t);w<i;){if(typeof o=="function"&&o(w,t,m,x,A)){Q="Callback returned true";break}if(!j(E(x))){Q="Gradient has Infinity or NaN";break}if(v=M(B(A,x)),!j(E(v))){Q="Search direction has Infinity or NaN";break}if(q=s(v),q<r){Q="Newton step smaller than tol";break}for(k=1,p=B(x,v),C=t;w<i&&!(k*q<r);){if(_=h(v,k),C=D(t,_),c=e(C),c-m>=.1*k*p||isNaN(c)){k*=.5,++w;continue}break}if(k*q<r){Q="Line search step size smaller than tol";break}if(w===i){Q="maxit reached during line search";break}b=u(C),V=g(b,x),S=B(V,_),L=B(A,V),A=g(D(A,h((S+B(V,L))/(S*S),y(_,_))),F(D(y(L,_),y(_,L)),S)),t=C,m=c,x=b,++w}return{solution:t,f:m,gradient:x,invHessian:A,iterations:w,message:Q}},numeric.Dopri=function(e,t,r,u,i,o,n){this.x=e,this.y=t,this.f=r,this.ymid=u,this.iterations=i,this.events=n,this.message=o},numeric.Dopri.prototype._at=function(e,t){function r(F){return F*F}var u=this,i=u.x,o=u.y,n=u.f,f=u.ymid;i.length;var a,m,c,p,l,s,e,v,x=.5,b=numeric.add,A=numeric.mul,B=numeric.sub,g,D,y;return a=i[t],m=i[t+1],p=o[t],l=o[t+1],v=m-a,c=a+x*v,s=f[t],g=B(n[t],A(p,1/(a-c)+2/(a-m))),D=B(n[t+1],A(l,1/(m-c)+2/(m-a))),y=[r(e-m)*(e-c)/r(a-m)/(a-c),r(e-a)*r(e-m)/r(a-c)/r(m-c),r(e-a)*(e-c)/r(m-a)/(m-c),(e-a)*r(e-m)*(e-c)/r(a-m)/(a-c),(e-m)*r(e-a)*(e-c)/r(a-m)/(m-c)],b(b(b(b(A(p,y[0]),A(s,y[1])),A(l,y[2])),A(g,y[3])),A(D,y[4]))},numeric.Dopri.prototype.at=function(e){var t,r,u,i=Math.floor;if(typeof e!="number"){var o=e.length,n=Array(o);for(t=o-1;t!==-1;--t)n[t]=this.at(e[t]);return n}var f=this.x;for(t=0,r=f.length-1;r-t>1;)u=i(.5*(t+r)),f[u]<=e?t=u:r=u;return this._at(e,t)},numeric.dopri=function(e,t,r,u,i,o,n){typeof i=="undefined"&&(i=1e-6),typeof o=="undefined"&&(o=1e3);var f=[e],a=[r],m=[u(e,r)],c,p,l,s,v,x,b=[],A=1/5,B=[3/40,9/40],g=[44/45,-56/15,32/9],D=[19372/6561,-25360/2187,64448/6561,-212/729],y=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],F=[35/384,0,500/1113,125/192,-2187/6784,11/84],h=[.5*6025192743/30085553152,0,.5*51252292925/65400821598,.5*-2691868925/45128329728,.5*187940372067/1594534317056,.5*-1776094331/19743644256,.5*11237099/235043384],j=[1/5,3/10,4/5,8/9,1,1],E=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],M=0,w,_,C=(t-e)/10,V=0,L=numeric.add,S=numeric.mul,k,q,Q=Math.min,W=Math.abs,U=numeric.norminf,P=Math.pow,G=numeric.any,X=numeric.lt,R=numeric.and;numeric.sub;var N,I,z,Y=new numeric.Dopri(f,a,m,b,-1,"");for(typeof n=="function"&&(N=n(e,r));e<t&&V<o;){if(++V,e+C>t&&(C=t-e),c=u(e+j[0]*C,L(r,S(A*C,m[M]))),p=u(e+j[1]*C,L(L(r,S(B[0]*C,m[M])),S(B[1]*C,c))),l=u(e+j[2]*C,L(L(L(r,S(g[0]*C,m[M])),S(g[1]*C,c)),S(g[2]*C,p))),s=u(e+j[3]*C,L(L(L(L(r,S(D[0]*C,m[M])),S(D[1]*C,c)),S(D[2]*C,p)),S(D[3]*C,l))),v=u(e+j[4]*C,L(L(L(L(L(r,S(y[0]*C,m[M])),S(y[1]*C,c)),S(y[2]*C,p)),S(y[3]*C,l)),S(y[4]*C,s))),k=L(L(L(L(L(r,S(m[M],C*F[0])),S(p,C*F[2])),S(l,C*F[3])),S(s,C*F[4])),S(v,C*F[5])),x=u(e+C,k),w=L(L(L(L(L(S(m[M],C*E[0]),S(p,C*E[2])),S(l,C*E[3])),S(s,C*E[4])),S(v,C*E[5])),S(x,C*E[6])),typeof w=="number"?q=W(w):q=U(w),q>i){if(C=.2*C*P(i/q,.25),e+C===e){Y.msg="Step size became too small";break}continue}if(b[M]=L(L(L(L(L(L(r,S(m[M],C*h[0])),S(p,C*h[2])),S(l,C*h[3])),S(s,C*h[4])),S(v,C*h[5])),S(x,C*h[6])),++M,f[M]=e+C,a[M]=k,m[M]=x,typeof n=="function"){var Z,J=e,$=e+.5*C,O;if(I=n($,b[M-1]),z=R(X(N,0),X(0,I)),G(z)||(J=$,$=e+C,N=I,I=n($,k),z=R(X(N,0),X(0,I))),G(z)){for(var nr,rr,er=0,H=1,K=1;;){if(typeof N=="number")O=(K*I*J-H*N*$)/(K*I-H*N);else for(O=$,_=N.length-1;_!==-1;--_)N[_]<0&&I[_]>0&&(O=Q(O,(K*I[_]*J-H*N[_]*$)/(K*I[_]-H*N[_])));if(O<=J||O>=$)break;Z=Y._at(O,M-1),rr=n(O,Z),nr=R(X(N,0),X(0,rr)),G(nr)?($=O,I=rr,z=nr,K=1,er===-1?H*=.5:H=1,er=-1):(J=O,N=rr,H=1,er===1?K*=.5:K=1,er=1)}return k=Y._at(.5*(e+O),M-1),Y.f[M]=u(O,Z),Y.x[M]=O,Y.y[M]=Z,Y.ymid[M-1]=k,Y.events=z,Y.iterations=V,Y}}e+=C,r=k,N=I,C=Q(.8*C*P(i/q,.25),4*C)}return Y.iterations=V,Y},numeric.LU=function(d,e){e=e||!1;var t=Math.abs,r,u,i,o,n,f,a,m,c,p=d.length,l=p-1,s=new Array(p);for(e||(d=numeric.clone(d)),i=0;i<p;++i){for(a=i,f=d[i],c=t(f[i]),u=i+1;u<p;++u)o=t(d[u][i]),c<o&&(c=o,a=u);for(s[i]=a,a!=i&&(d[i]=d[a],d[a]=f,f=d[i]),n=f[i],r=i+1;r<p;++r)d[r][i]/=n;for(r=i+1;r<p;++r){for(m=d[r],u=i+1;u<l;++u)m[u]-=m[i]*f[u],++u,m[u]-=m[i]*f[u];u===l&&(m[u]-=m[i]*f[u])}}return{LU:d,P:s}},numeric.LUsolve=function(e,t){var r,u,i=e.LU,o=i.length,n=numeric.clone(t),f=e.P,a,m,c;for(r=o-1;r!==-1;--r)n[r]=t[r];for(r=0;r<o;++r)for(a=f[r],f[r]!==r&&(c=n[r],n[r]=n[a],n[a]=c),m=i[r],u=0;u<r;++u)n[r]-=n[u]*m[u];for(r=o-1;r>=0;--r){for(m=i[r],u=r+1;u<o;++u)n[r]-=n[u]*m[u];n[r]/=m[r]}return n},numeric.solve=function(e,t,r){return numeric.LUsolve(numeric.LU(e,r),t)},numeric.echelonize=function(e){var t=numeric.dim(e),r=t[0],u=t[1],i=numeric.identity(r),o=Array(r),n,f,a,m,c,p,l,s,v=Math.abs,x=numeric.diveq;for(e=numeric.clone(e),n=0;n<r;++n){for(a=0,c=e[n],p=i[n],f=1;f<u;++f)v(c[a])<v(c[f])&&(a=f);for(o[n]=a,x(p,c[a]),x(c,c[a]),f=0;f<r;++f)if(f!==n){for(l=e[f],s=l[a],m=u-1;m!==-1;--m)l[m]-=c[m]*s;for(l=i[f],m=r-1;m!==-1;--m)l[m]-=p[m]*s}}return{I:i,A:e,P:o}},numeric.__solveLP=function(e,t,r,u,i,o,n){var f=numeric.sum;numeric.log;var a=numeric.mul,m=numeric.sub,c=numeric.dot,p=numeric.div,l=numeric.add,s=e.length,v=r.length,x,b=!1,A=0,B=1;numeric.transpose(t),numeric.svd;var g=numeric.transpose;numeric.leq;var D=Math.sqrt,y=Math.abs;numeric.muleq,numeric.norminf,numeric.any;var F=Math.min,h=numeric.all,j=numeric.gt,E=Array(s),M=Array(v);numeric.rep([v],1);var w,_=numeric.solve,C=m(r,c(t,o)),V,L=c(e,e),S;for(V=A;V<i;++V){var k,q;for(k=v-1;k!==-1;--k)M[k]=p(t[k],C[k]);var Q=g(M);for(k=s-1;k!==-1;--k)E[k]=f(Q[k]);B=.25*y(L/c(e,E));var W=100*D(L/c(E,E));for((!isFinite(B)||B>W)&&(B=W),S=l(e,a(B,E)),w=c(Q,M),k=s-1;k!==-1;--k)w[k][k]+=1;q=_(w,p(S,B),!0);var U=p(C,c(t,q)),P=1;for(k=v-1;k!==-1;--k)U[k]<0&&(P=F(P,-.999*U[k]));if(x=m(o,a(q,P)),C=m(r,c(t,x)),!h(j(C,0)))return{solution:o,message:"",iterations:V};if(o=x,B<u)return{solution:x,message:"",iterations:V};if(n){var G=c(e,S),X=c(t,S);for(b=!0,k=v-1;k!==-1;--k)if(G*X[k]<0){b=!1;break}}else o[s-1]>=0?b=!1:b=!0;if(b)return{solution:x,message:"Unbounded",iterations:V}}return{solution:o,message:"maximum iteration count exceeded",iterations:V}},numeric._solveLP=function(e,t,r,u,i){var o=e.length,n=r.length,f;numeric.sum,numeric.log,numeric.mul;var a=numeric.sub,m=numeric.dot;numeric.div,numeric.add;var c=numeric.rep([o],0).concat([1]),p=numeric.rep([n,1],-1),l=numeric.blockMatrix([[t,p]]),s=r,f=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),v=numeric.__solveLP(c,l,s,u,i,f,!1),x=numeric.clone(v.solution);x.length=o;var b=numeric.inf(a(r,m(t,x)));if(b<0)return{solution:NaN,message:"Infeasible",iterations:v.iterations};var A=numeric.__solveLP(e,t,r,u,i-v.iterations,x,!0);return A.iterations+=v.iterations,A},numeric.solveLP=function(e,t,r,u,i,o,n){if(typeof n=="undefined"&&(n=1e3),typeof o=="undefined"&&(o=numeric.epsilon),typeof u=="undefined")return numeric._solveLP(e,t,r,o,n);var f=u.length,a=u[0].length,m=t.length,c=numeric.echelonize(u),p=numeric.rep([a],0),l=c.P,s=[],v;for(v=l.length-1;v!==-1;--v)p[l[v]]=1;for(v=a-1;v!==-1;--v)p[v]===0&&s.push(v);var x=numeric.getRange,b=numeric.linspace(0,f-1),A=numeric.linspace(0,m-1),B=x(u,b,s),g=x(t,A,l),D=x(t,A,s),y=numeric.dot,F=numeric.sub,h=y(g,c.I),j=F(D,y(h,B)),E=F(r,y(h,i)),M=Array(l.length),w=Array(s.length);for(v=l.length-1;v!==-1;--v)M[v]=e[l[v]];for(v=s.length-1;v!==-1;--v)w[v]=e[s[v]];var _=F(w,y(M,y(c.I,B))),C=numeric._solveLP(_,j,E,o,n),V=C.solution;if(V!==V)return C;var L=y(c.I,F(i,y(B,V))),S=Array(e.length);for(v=l.length-1;v!==-1;--v)S[l[v]]=L[v];for(v=s.length-1;v!==-1;--v)S[s[v]]=V[v];return{solution:S,message:C.message,iterations:C.iterations}},numeric.MPStoLP=function(e){e instanceof String&&e.split(`
`);var t=0,r=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=e.length,i,o,n,f=0,a={},m=[],c=0,p={},l=0,s,v=[],x=[],b=[];function A(F){throw new Error("MPStoLP: "+F+`
Line `+i+": "+e[i]+`
Current state: `+r[t]+`
`)}for(i=0;i<u;++i){n=e[i];var B=n.match(/\S*/g),g=[];for(o=0;o<B.length;++o)B[o]!==""&&g.push(B[o]);if(g.length!==0){for(o=0;o<r.length&&n.substr(0,r[o].length)!==r[o];++o);if(o<r.length){if(t=o,o===1&&(s=g[1]),o===6)return{name:s,c:v,A:numeric.transpose(x),b,rows:a,vars:p};continue}switch(t){case 0:case 1:A("Unexpected line");case 2:switch(g[0]){case"N":f===0?f=g[1]:A("Two or more N rows");break;case"L":a[g[1]]=c,m[c]=1,b[c]=0,++c;break;case"G":a[g[1]]=c,m[c]=-1,b[c]=0,++c;break;case"E":a[g[1]]=c,m[c]=0,b[c]=0,++c;break;default:A("Parse error "+numeric.prettyPrint(g))}break;case 3:p.hasOwnProperty(g[0])||(p[g[0]]=l,v[l]=0,x[l]=numeric.rep([c],0),++l);var D=p[g[0]];for(o=1;o<g.length;o+=2){if(g[o]===f){v[D]=parseFloat(g[o+1]);continue}var y=a[g[o]];x[D][y]=(m[y]<0?-1:1)*parseFloat(g[o+1])}break;case 4:for(o=1;o<g.length;o+=2)b[a[g[o]]]=(m[a[g[o]]]<0?-1:1)*parseFloat(g[o+1]);break;case 5:break;case 6:A("Internal error")}}}A("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(d,e,t,r,u,i,o){e.seedrandom=function(p,l){var s=[],v;return p=a(f(l?[p,d]:arguments.length?p:[new Date().getTime(),d,window],3),s),v=new n(s),a(v.S,d),e.random=function(){for(var b=v.g(r),A=o,B=0;b<u;)b=(b+B)*t,A*=t,B=v.g(1);for(;b>=i;)b/=2,A/=2,B>>>=1;return(b+B)/A},p};function n(c){var p,l,s=this,v=c.length,x=0,b=s.i=s.j=s.m=0;for(s.S=[],s.c=[],v||(c=[v++]);x<t;)s.S[x]=x++;for(x=0;x<t;x++)p=s.S[x],b=m(b+p+c[x%v]),l=s.S[b],s.S[x]=l,s.S[b]=p;s.g=function(B){var g=s.S,D=m(s.i+1),y=g[D],F=m(s.j+y),h=g[F];g[D]=h,g[F]=y;for(var j=g[m(y+h)];--B;)D=m(D+1),y=g[D],F=m(F+y),h=g[F],g[D]=h,g[F]=y,j=j*t+g[m(y+h)];return s.i=D,s.j=F,j},s.g(t)}function f(c,p,l,s,v){if(l=[],v=typeof c,p&&v=="object"){for(s in c)if(s.indexOf("S")<5)try{l.push(f(c[s],p-1))}catch(x){}}return l.length?l:c+(v!="string"?"\0":"")}function a(c,p,l,s){for(c+="",l=0,s=0;s<c.length;s++)p[m(s)]=m((l^=p[m(s)]*19)+c.charCodeAt(s));c="";for(s in p)c+=String.fromCharCode(p[s]);return c}function m(c){return c&t-1}o=e.pow(t,r),u=e.pow(2,u),i=u*2,a(e.random(),d)}([],numeric.seedrandom,256,6,52),function(d){function e(f){if(typeof f!="object")return f;var a=[],m,c=f.length;for(m=0;m<c;m++)a[m+1]=e(f[m]);return a}function t(f){if(typeof f!="object")return f;var a=[],m,c=f.length;for(m=1;m<c;m++)a[m-1]=t(f[m]);return a}function r(f,a,m){var c,p,l,s,v;for(l=1;l<=m;l=l+1){for(f[l][l]=1/f[l][l],v=-f[l][l],c=1;c<l;c=c+1)f[c][l]=v*f[c][l];if(s=l+1,m<s)break;for(p=s;p<=m;p=p+1)for(v=f[l][p],f[l][p]=0,c=1;c<=l;c=c+1)f[c][p]=f[c][p]+v*f[c][l]}}function u(f,a,m,c){var p,l,s,v;for(l=1;l<=m;l=l+1){for(v=0,p=1;p<l;p=p+1)v=v+f[p][l]*c[p];c[l]=(c[l]-v)/f[l][l]}for(s=1;s<=m;s=s+1)for(l=m+1-s,c[l]=c[l]/f[l][l],v=-c[l],p=1;p<l;p=p+1)c[p]=c[p]+v*f[p][l]}function i(f,a,m,c){var p,l,s,v,x,b;for(l=1;l<=m;l=l+1){if(c[1]=l,b=0,s=l-1,s<1){if(b=f[l][l]-b,b<=0)break;f[l][l]=Math.sqrt(b)}else{for(v=1;v<=s;v=v+1){for(x=f[v][l],p=1;p<v;p=p+1)x=x-f[p][l]*f[p][v];x=x/f[v][v],f[v][l]=x,b=b+x*x}if(b=f[l][l]-b,b<=0)break;f[l][l]=Math.sqrt(b)}c[1]=0}}function o(f,a,m,c,p,l,s,v,x,b,A,B,g,D,y,F){var h,j,E,M,w,_,C,V,L,S,k,q,Q,W,U,P,G,X,R,N,I,z,Y,Z,J,$,O;Q=Math.min(c,b),E=2*c+Q*(Q+5)/2+2*b+1,Z=1e-60;do Z=Z+Z,J=1+.1*Z,$=1+.2*Z;while(J<=1||$<=1);for(h=1;h<=c;h=h+1)y[h]=a[h];for(h=c+1;h<=E;h=h+1)y[h]=0;for(h=1;h<=b;h=h+1)B[h]=0;if(w=[],F[1]===0){if(i(f,m,c,w),w[1]!==0){F[1]=2;return}u(f,m,c,a),r(f,m,c)}else{for(j=1;j<=c;j=j+1)for(p[j]=0,h=1;h<=j;h=h+1)p[j]=p[j]+f[h][j]*a[h];for(j=1;j<=c;j=j+1)for(a[j]=0,h=j;h<=c;h=h+1)a[j]=a[j]+f[j][h]*p[h]}for(l[1]=0,j=1;j<=c;j=j+1)for(p[j]=a[j],l[1]=l[1]+y[j]*p[j],y[j]=0,h=j+1;h<=c;h=h+1)f[h][j]=0;for(l[1]=-l[1]/2,F[1]=0,C=c,V=C+c,k=V+Q,L=k+Q+1,S=L+Q*(Q+1)/2,W=S+b,h=1;h<=b;h=h+1){for(P=0,j=1;j<=c;j=j+1)P=P+s[j][h]*s[j][h];y[W+h]=Math.sqrt(P)}g=0,D[1]=0,D[2]=0;function nr(){for(D[1]=D[1]+1,E=S,h=1;h<=b;h=h+1){for(E=E+1,P=-v[h],j=1;j<=c;j=j+1)P=P+s[j][h]*p[j];if(Math.abs(P)<Z&&(P=0),h>A)y[E]=P;else if(y[E]=-Math.abs(P),P>0){for(j=1;j<=c;j=j+1)s[j][h]=-s[j][h];v[h]=-v[h]}}for(h=1;h<=g;h=h+1)y[S+B[h]]=0;for(q=0,U=0,h=1;h<=b;h=h+1)y[S+h]<U*y[W+h]&&(q=h,U=y[S+h]/y[W+h]);return q===0?999:0}function rr(){for(h=1;h<=c;h=h+1){for(P=0,j=1;j<=c;j=j+1)P=P+f[j][h]*s[j][q];y[h]=P}for(M=C,h=1;h<=c;h=h+1)y[M+h]=0;for(j=g+1;j<=c;j=j+1)for(h=1;h<=c;h=h+1)y[M+h]=y[M+h]+f[h][j]*y[j];for(z=!0,h=g;h>=1;h=h-1){for(P=y[h],E=L+h*(h+3)/2,M=E-h,j=h+1;j<=g;j=j+1)P=P-y[E]*y[V+j],E=E+j;if(P=P/y[M],y[V+h]=P,B[h]<A||P<0)break;z=!1,_=h}if(!z)for(G=y[k+_]/y[V+_],h=1;h<=g&&!(B[h]<A||y[V+h]<0);h=h+1)U=y[k+h]/y[V+h],U<G&&(G=U,_=h);for(P=0,h=C+1;h<=C+c;h=h+1)P=P+y[h]*y[h];if(Math.abs(P)<=Z){if(z)return F[1]=1,999;for(h=1;h<=g;h=h+1)y[k+h]=y[k+h]-G*y[V+h];return y[k+g+1]=y[k+g+1]+G,700}else{for(P=0,h=1;h<=c;h=h+1)P=P+y[C+h]*s[h][q];for(X=-y[S+q]/P,Y=!0,z||G<X&&(X=G,Y=!1),h=1;h<=c;h=h+1)p[h]=p[h]+X*y[C+h],Math.abs(p[h])<Z&&(p[h]=0);for(l[1]=l[1]+X*P*(X/2+y[k+g+1]),h=1;h<=g;h=h+1)y[k+h]=y[k+h]-X*y[V+h];if(y[k+g+1]=y[k+g+1]+X,Y){for(g=g+1,B[g]=q,E=L+(g-1)*g/2+1,h=1;h<=g-1;h=h+1)y[E]=y[h],E=E+1;if(g===c)y[E]=y[c];else{for(h=c;h>=g+1&&!(y[h]===0||(R=Math.max(Math.abs(y[h-1]),Math.abs(y[h])),N=Math.min(Math.abs(y[h-1]),Math.abs(y[h])),y[h-1]>=0?U=Math.abs(R*Math.sqrt(1+N*N/(R*R))):U=-Math.abs(R*Math.sqrt(1+N*N/(R*R))),R=y[h-1]/U,N=y[h]/U,R===1));h=h-1)if(R===0)for(y[h-1]=N*U,j=1;j<=c;j=j+1)U=f[j][h-1],f[j][h-1]=f[j][h],f[j][h]=U;else for(y[h-1]=U,I=N/(1+R),j=1;j<=c;j=j+1)U=R*f[j][h-1]+N*f[j][h],f[j][h]=I*(f[j][h-1]+U)-f[j][h],f[j][h-1]=U;y[E]=y[g]}}else{for(P=-v[q],j=1;j<=c;j=j+1)P=P+p[j]*s[j][q];if(q>A)y[S+q]=P;else if(y[S+q]=-Math.abs(P),P>0){for(j=1;j<=c;j=j+1)s[j][q]=-s[j][q];v[q]=-v[q]}return 700}}return 0}function er(){if(E=L+_*(_+1)/2+1,M=E+_,y[M]===0||(R=Math.max(Math.abs(y[M-1]),Math.abs(y[M])),N=Math.min(Math.abs(y[M-1]),Math.abs(y[M])),y[M-1]>=0?U=Math.abs(R*Math.sqrt(1+N*N/(R*R))):U=-Math.abs(R*Math.sqrt(1+N*N/(R*R))),R=y[M-1]/U,N=y[M]/U,R===1))return 798;if(R===0){for(h=_+1;h<=g;h=h+1)U=y[M-1],y[M-1]=y[M],y[M]=U,M=M+h;for(h=1;h<=c;h=h+1)U=f[h][_],f[h][_]=f[h][_+1],f[h][_+1]=U}else{for(I=N/(1+R),h=_+1;h<=g;h=h+1)U=R*y[M-1]+N*y[M],y[M]=I*(y[M-1]+U)-y[M],y[M-1]=U,M=M+h;for(h=1;h<=c;h=h+1)U=R*f[h][_]+N*f[h][_+1],f[h][_+1]=I*(f[h][_]+U)-f[h][_+1],f[h][_]=U}return 0}function H(){for(M=E-_,h=1;h<=_;h=h+1)y[M]=y[E],E=E+1,M=M+1;return y[k+_]=y[k+_+1],B[_]=B[_+1],_=_+1,_<g?797:0}function K(){return y[k+g]=y[k+g+1],y[k+g+1]=0,B[g]=0,g=g-1,D[2]=D[2]+1,0}for(O=0;;){if(O=nr(),O===999)return;for(;O=rr(),O!==0;){if(O===999)return;if(O===700)if(_===g)K();else{for(;er(),O=H(),O===797;);K()}}}}function n(f,a,m,c,p,l){f=e(f),a=e(a),m=e(m);var s,v,x,b,A,B=[],g=[],D=[],y=[],F=[],h;if(p=p||0,l=l?e(l):[void 0,0],c=c?e(c):[],v=f.length-1,x=m[1].length-1,!c)for(s=1;s<=x;s=s+1)c[s]=0;for(s=1;s<=x;s=s+1)g[s]=0;for(b=0,A=Math.min(v,x),s=1;s<=v;s=s+1)D[s]=0;for(B[1]=0,s=1;s<=2*v+A*(A+5)/2+2*x+1;s=s+1)y[s]=0;for(s=1;s<=2;s=s+1)F[s]=0;return o(f,a,v,v,D,B,m,c,v,x,p,g,b,F,y,l),h="",l[1]===1&&(h="constraints are inconsistent, no solution!"),l[1]===2&&(h="matrix D in quadratic function is not positive definite!"),{solution:t(D),value:t(B),unconstrained_solution:t(a),iterations:t(F),iact:t(g),message:h}}d.solveQP=n}(numeric),numeric.svd=function(e){var t,r=numeric.epsilon,u=1e-64/r,i=50,o=0,n=0,f=0,a=0,m=0,c=numeric.clone(e),p=c.length,l=c[0].length;if(p<l)throw"Need more rows than columns";var s=new Array(l),v=new Array(l);for(n=0;n<l;n++)s[n]=v[n]=0;var x=numeric.rep([l,l],0);function b(w,_){return w=Math.abs(w),_=Math.abs(_),w>_?w*Math.sqrt(1+_*_/w/w):_==0?w:_*Math.sqrt(1+w*w/_/_)}var A=0,B=0,g=0,D=0,y=0,F=0,h=0;for(n=0;n<l;n++){for(s[n]=B,h=0,m=n+1,f=n;f<p;f++)h+=c[f][n]*c[f][n];if(h<=u)B=0;else for(A=c[n][n],B=Math.sqrt(h),A>=0&&(B=-B),g=A*B-h,c[n][n]=A-B,f=m;f<l;f++){for(h=0,a=n;a<p;a++)h+=c[a][n]*c[a][f];for(A=h/g,a=n;a<p;a++)c[a][f]+=A*c[a][n]}for(v[n]=B,h=0,f=m;f<l;f++)h=h+c[n][f]*c[n][f];if(h<=u)B=0;else{for(A=c[n][n+1],B=Math.sqrt(h),A>=0&&(B=-B),g=A*B-h,c[n][n+1]=A-B,f=m;f<l;f++)s[f]=c[n][f]/g;for(f=m;f<p;f++){for(h=0,a=m;a<l;a++)h+=c[f][a]*c[n][a];for(a=m;a<l;a++)c[f][a]+=h*s[a]}}y=Math.abs(v[n])+Math.abs(s[n]),y>D&&(D=y)}for(n=l-1;n!=-1;n+=-1){if(B!=0){for(g=B*c[n][n+1],f=m;f<l;f++)x[f][n]=c[n][f]/g;for(f=m;f<l;f++){for(h=0,a=m;a<l;a++)h+=c[n][a]*x[a][f];for(a=m;a<l;a++)x[a][f]+=h*x[a][n]}}for(f=m;f<l;f++)x[n][f]=0,x[f][n]=0;x[n][n]=1,B=s[n],m=n}for(n=l-1;n!=-1;n+=-1){for(m=n+1,B=v[n],f=m;f<l;f++)c[n][f]=0;if(B!=0){for(g=c[n][n]*B,f=m;f<l;f++){for(h=0,a=m;a<p;a++)h+=c[a][n]*c[a][f];for(A=h/g,a=n;a<p;a++)c[a][f]+=A*c[a][n]}for(f=n;f<p;f++)c[f][n]=c[f][n]/B}else for(f=n;f<p;f++)c[f][n]=0;c[n][n]+=1}for(r=r*D,a=l-1;a!=-1;a+=-1)for(var j=0;j<i;j++){var E=!1;for(m=a;m!=-1;m+=-1){if(Math.abs(s[m])<=r){E=!0;break}if(Math.abs(v[m-1])<=r)break}if(!E){o=0,h=1;var M=m-1;for(n=m;n<a+1&&(A=h*s[n],s[n]=o*s[n],!(Math.abs(A)<=r));n++)for(B=v[n],g=b(A,B),v[n]=g,o=B/g,h=-A/g,f=0;f<p;f++)y=c[f][M],F=c[f][n],c[f][M]=y*o+F*h,c[f][n]=-y*h+F*o}if(F=v[a],m==a){if(F<0)for(v[a]=-F,f=0;f<l;f++)x[f][a]=-x[f][a];break}if(j>=i-1)throw"Error: no convergence.";for(D=v[m],y=v[a-1],B=s[a-1],g=s[a],A=((y-F)*(y+F)+(B-g)*(B+g))/(2*g*y),B=b(A,1),A<0?A=((D-F)*(D+F)+g*(y/(A-B)-g))/D:A=((D-F)*(D+F)+g*(y/(A+B)-g))/D,o=1,h=1,n=m+1;n<a+1;n++){for(B=s[n],y=v[n],g=h*B,B=o*B,F=b(A,g),s[n-1]=F,o=A/F,h=g/F,A=D*o+B*h,B=-D*h+B*o,g=y*h,y=y*o,f=0;f<l;f++)D=x[f][n-1],F=x[f][n],x[f][n-1]=D*o+F*h,x[f][n]=-D*h+F*o;for(F=b(A,g),v[n-1]=F,o=A/F,h=g/F,A=o*B+h*y,D=-h*B+o*y,f=0;f<p;f++)y=c[f][n-1],F=c[f][n],c[f][n-1]=y*o+F*h,c[f][n]=-y*h+F*o}s[m]=0,s[a]=A,v[a]=D}for(n=0;n<v.length;n++)v[n]<r&&(v[n]=0);for(n=0;n<l;n++)for(f=n-1;f>=0;f--)if(v[f]<v[n]){for(o=v[f],v[f]=v[n],v[n]=o,a=0;a<c.length;a++)t=c[a][n],c[a][n]=c[a][f],c[a][f]=t;for(a=0;a<x.length;a++)t=x[a][n],x[a][n]=x[a][f],x[a][f]=t;n=f}return{U:c,S:v,V:x}}});export default numeric1_2_6;
