import{r as o}from"./common/index-378ae6ec.js";import"./common/index-123a6ecf.js";import"./common/hoist-non-react-statics.cjs-db9215a0.js";import{r as w}from"./common/index-b63a030f.js";import"./common/_commonjsHelpers-4f955397.js";var a=o.createContext(null);function E(e){e()}var S=E,k=function(t){return S=t},N=function(){return S},m={notify:function(){}};function j(){var e=N(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var n=t;n;)n.callback(),n=n.next})},get:function(){for(var n=[],c=t;c;)n.push(c),c=c.next;return n},subscribe:function(n){var c=!0,u=r={callback:n,next:null,prev:r};return u.prev?u.prev.next=u:t=u,function(){!c||t===null||(c=!1,u.next?u.next.prev=u.prev:r=u.prev,u.prev?u.prev.next=u.next:t=u.next)}}}}var y=function(){function e(r,s){this.store=r,this.parentSub=s,this.unsubscribe=null,this.listeners=m,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(s){return this.trySubscribe(),this.listeners.subscribe(s)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=j())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=m)},e}();function W(e){var t=e.store,r=e.context,s=e.children,n=o.useMemo(function(){var i=new y(t);return i.onStateChange=i.notifyNestedSubs,{store:t,subscription:i}},[t]),c=o.useMemo(function(){return t.getState()},[t]);o.useEffect(function(){var i=n.subscription;return i.trySubscribe(),c!==t.getState()&&i.notifyNestedSubs(),function(){i.tryUnsubscribe(),i.onStateChange=null}},[n,c]);var u=r||a;return o.createElement(u.Provider,{value:n},s)}var x=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined"?o.useLayoutEffect:o.useEffect;function C(){var e=o.useContext(a);return e}function g(e){e===void 0&&(e=a);var t=e===a?C:function(){return o.useContext(e)};return function(){var s=t(),n=s.store;return n}}var B=g();function U(e){e===void 0&&(e=a);var t=e===a?B:g(e);return function(){var s=t();return s.dispatch}}var D=U(),H=function(t,r){return t===r};function L(e,t,r,s){var n=o.useReducer(function(f){return f+1},0),c=n[1],u=o.useMemo(function(){return new y(r,s)},[r,s]),i=o.useRef(),b=o.useRef(),v=o.useRef(),l=o.useRef(),d=r.getState(),h;try{e!==b.current||d!==v.current||i.current?h=e(d):h=l.current}catch(f){throw i.current&&(f.message+=`
The error may be correlated with this previous error:
`+i.current.stack+`

`),f}return x(function(){b.current=e,v.current=d,l.current=h,i.current=void 0}),x(function(){function f(){try{var p=b.current(r.getState());if(t(p,l.current))return;l.current=p}catch(R){i.current=R}c()}return u.onStateChange=f,u.trySubscribe(),f(),function(){return u.tryUnsubscribe()}},[r,u]),h}function _(e){e===void 0&&(e=a);var t=e===a?C:function(){return o.useContext(e)};return function(s,n){n===void 0&&(n=H);var c=t(),u=c.store,i=c.subscription,b=L(s,n,u,i);return o.useDebugValue(b),b}}var M=_();k(w.unstable_batchedUpdates);export{W as Provider,D as useDispatch,M as useSelector};
