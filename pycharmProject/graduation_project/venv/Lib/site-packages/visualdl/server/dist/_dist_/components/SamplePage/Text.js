function b(){return b=Object.assign||function(r){for(var l=1;l<arguments.length;l++){var o=arguments[l];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r},b.apply(this,arguments)}import e,{useCallback as _,useEffect as C,useState as z}from"../../../web_modules/react.js";import{borderRadius as d,ellipsis as j,em as N,rem as t,sameBorder as x,size as T,transitionProps as s}from"../../utils/style.js";import I,{useRunningRequest as L}from"../../hooks/useRequest.js";import O from"../Loader/ContentLoader.js";import R from"../Icon.js";import{TextChart as u}from"../Loader/ChartPage.js";import{fetcher as q}from"../../utils/fetch.js";import{getEntityUrl as W}from"./SampleChart.js";import F from"../../../web_modules/query-string.js";import h from"../../../web_modules/styled-components.js";import{useTranslation as P}from"../../../web_modules/react-i18next.js";const E=h.div.withConfig({displayName:"Text__Wrapper",componentId:"ljrhzz-0"})(["width:100%;"]),v=h.h4.withConfig({displayName:"Text__Title",componentId:"ljrhzz-1"})(["cursor:pointer;background-color:var(--text-chart-title-background-color);display:flex;justify-content:space-between;align-items:center;height:",";margin:0;padding:0 "," 0 ",";border-radius:",";font-weight:400;font-size:",";"," .tag{flex:auto;font-weight:700;&::before{content:'';display:inline-block;"," margin-right:",";border-radius:",";vertical-align:middle;background-color:var(--text-chart-title-indicator-color);","}}.run{flex:none;color:var(--text-lighter-color);"," "," max-width:50%;&::before{content:'';display:inline-block;"," margin-right:",";border-radius:",";vertical-align:middle;background-color:",";}}.steps{flex:none;color:var(--text-lighter-color);margin-left:",";}.icon{margin-left:",";font-size:",";color:var(--text-lighter-color);transform:rotate(","deg);",";}"],t(40),t(20),t(12),d,N(14),s("background-color"),T(t(10),t(3)),t(8),t(1.5),s("background-color"),s("color"),j(),T(t(9),t(9)),t(8),t(4.5),r=>r.color,t(12),t(20),t(10),r=>r.opened?"180":"0",s(["transform","color"])),g=h.div.withConfig({displayName:"Text__TextWrapper",componentId:"ljrhzz-2"})(["height:",";margin-top:",";display:flex;justify-content:flex-start;align-items:center;padding:0;"," ",""],t(40),t(12),x(!0),s("border-color")),S=h.div.withConfig({displayName:"Text__TextGrid",componentId:"ljrhzz-3"})(["margin-top:",";display:grid;grid-template-columns:fit-content(25%) auto;grid-row-gap:",";justify-items:stretch;align-items:stretch;"," > span{height:",";line-height:1.857142857;padding:"," 0;}.step{"," border-right:none;border-top-left-radius:",";border-bottom-left-radius:",";padding-left:",";padding-right:",";> span{display:block;width:100%;color:var(--text-light-color);background-color:var(--text-chart-tag-background-color);padding:0 ",";border-radius:",";","}}.text{"," border-left:none;border-top-right-radius:",";border-bottom-right-radius:",";padding-right:",";"," > *{vertical-align:middle;}}"],t(12),t(12),s("border-color"),t(40),t(7),x(),d,d,t(8),t(14),t(8),d,s(["background-color","color"]),x(),d,d,t(20),j()),B=({run:r,tag:l,step:o,wallTime:a,index:c})=>{const{t:p}=P("sample"),{data:i,error:m,loading:n}=I(W("text",c,r,l,a),q,{dedupingInterval:5*60*1e3});return e.createElement(e.Fragment,null,e.createElement("span",{className:"step"},e.createElement("span",null,p("sample:step")," ",o)),e.createElement("span",{className:"text",title:i!=null?i:""},n?e.createElement(O,{viewBox:"0 0 640 16",height:"16"},e.createElement("rect",{x:"0",y:"0",rx:"3",ry:"3",width:(c+1)*250%640,height:"16"})):m!=null?m:i))},G=({run:r,tag:l,opened:o,running:a})=>{var c;const[p,i]=z(o!=null?o:!1);C(()=>i(o!=null?o:!1),[o]);const m=_(()=>i(f=>!f),[]),{data:n,error:y,loading:k}=L(`/text/list?${F.stringify({run:r.label,tag:l})}`,!!a);return e.createElement(E,null,e.createElement(v,{color:r.colors[0],opened:p,onClick:m},e.createElement("span",{className:"tag"},l),e.createElement("span",{className:"run"},r.label),e.createElement("span",{className:"steps"},(c=n==null?void 0:n.length)!==null&&c!==void 0?c:0),e.createElement(R,{className:"icon",type:"chevron-down"})),p?k?e.createElement(e.Fragment,null,e.createElement(g,null,e.createElement(u,{width:270})),e.createElement(g,null,e.createElement(u,{width:640}))):y?e.createElement(g,null,y):e.createElement(S,null,n==null?void 0:n.map((f,w)=>e.createElement(B,b({key:w},f,{run:r.label,tag:l,index:w})))):null)};export default G;export const Loader=()=>e.createElement(e.Fragment,null,e.createElement(E,null,e.createElement(v,{color:""}),e.createElement(g,null,e.createElement(u,{width:270})),e.createElement(g,null,e.createElement(u,{width:640}))),e.createElement(E,null,e.createElement(v,{color:""})));
