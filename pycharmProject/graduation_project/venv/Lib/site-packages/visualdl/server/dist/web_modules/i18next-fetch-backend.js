function O(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function b(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function x(n,t,e){return t&&b(n.prototype,t),e&&b(n,e),n}function s(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function P(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),e.push.apply(e,r)}return e}function w(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?P(Object(e),!0).forEach(function(r){s(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):P(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function D(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&p(n,t)}function l(n){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(n)}function p(n,t){return p=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},p(n,t)}function m(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}function y(n,t,e){return m()?y=Reflect.construct:y=function(o,u,a){var f=[null];f.push.apply(f,u);var i=Function.bind.apply(o,f),c=new i;return a&&p(c,a.prototype),c},y.apply(null,arguments)}function N(n){return Function.toString.call(n).indexOf("[native code]")!==-1}function g(n){var t=typeof Map=="function"?new Map:void 0;return g=function(r){if(r===null||!N(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,o)}function o(){return y(r,arguments,l(this).constructor)}return o.prototype=Object.create(r.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),p(o,r)},g(n)}function _(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function q(n,t){return t&&(typeof t=="object"||typeof t=="function")?t:_(n)}function L(n){return function(){var t=l(n),e;if(m()){var r=l(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return q(this,e)}}var M={loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",multiSeparator:"+",allowMultiLoading:!1,parse:JSON.parse,stringify:JSON.stringify,fetch,requestOptions:{}},T=function(t){return Array.isArray(t)?t:[t]},B=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return typeof t=="function"?t.apply(void 0,r):t},d=function(n){D(e,n);var t=L(e);function e(r){var o,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return O(this,e),o=t.call(this,r),s(_(o),"retry",null),o.retry=u,o}return e}(g(Error)),j=function(){function n(t,e){O(this,n),s(this,"type","backend"),this.init(t,e)}return x(n,[{key:"init",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.services=e,this.options=w({},M,{},this.options,{},r)}},{key:"getLoadPath",value:function(e,r){return B(this.options.loadPath,e,r)}},{key:"read",value:function(e,r,o){var u=this.getLoadPath(e,r),a=this.services.interpolator.interpolate(u,{lng:e,ns:r});this.loadUrl(a,o)}},{key:"readMulti",value:function(e,r,o){var u=this.getLoadPath(e,r),a=this.options.multiSeparator,f=this.services.interpolator.interpolate(u,{lng:e.join(a),ns:r.join(a)});this.loadUrl(f,o)}},{key:"loadUrl",value:function(e,r){var o=this.options,u=o.fetch,a=o.requestOptions,f=o.parse;u(e,a).then(function(i){var c=i.ok,h=i.status;if(!c){var v=h>=500&&h<600;throw new d("failed loading ".concat(e),v)}return i.text()},function(){throw new d("failed loading ".concat(e))}).then(function(i){try{return r(null,f(i,e))}catch(c){throw new d("failed parsing ".concat(e," to json"),!1)}}).catch(function(i){i instanceof d&&r(i.message,i.retry)})}},{key:"create",value:function(e,r,o,u){var a=this,f=s({},o,u||"");T(e).forEach(function(i){var c=a.options,h=c.addPath,v=c.requestOptions,S=c.fetch,k=c.stringify,E=a.services.interpolator.interpolate(h,{lng:i,ns:r});try{S(E,w({method:"POST",body:k(f)},v))}catch(R){console.error(R)}})}}]),n}();s(j,"type","backend");export default j;
