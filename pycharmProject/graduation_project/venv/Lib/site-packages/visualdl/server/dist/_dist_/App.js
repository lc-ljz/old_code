import g from"../__snowpack__/env.js";import.meta.env=g;import e,{Suspense as j,useCallback as w,useEffect as s,useMemo as b}from"../web_modules/react.js";import{Redirect as v,Route as i,BrowserRouter as R,Switch as x,useLocation as y}from"../web_modules/react-router-dom.js";import{THEME as N,matchMedia as c}from"./utils/theme.js";import{headerHeight as u,position as C,size as T,zIndexes as k}from"./utils/style.js";import A from"./components/ErrorBoundary.js";import d from"./pages/error.js";import{Helmet as P}from"../web_modules/react-helmet.js";import p from"../web_modules/nprogress.js";import S from"./components/Navbar.js";import{SWRConfig as B}from"../web_modules/swr.js";import{ToastContainer as I}from"../web_modules/react-toastify.js";import{actions as L}from"./store/index.js";import{fetcher as H}from"./utils/fetch.js";import f from"./routes/index.js";import h from"../web_modules/styled-components.js";import{useDispatch as M}from"../web_modules/react-redux.js";import{useTranslation as O}from"../web_modules/react-i18next.js";const E=import.meta.env.SNOWPACK_PUBLIC_BASE_URI,z=h.main.withConfig({displayName:"App__Main",componentId:"n063fb-0"})(["padding-top:",";"],u),D=h.header.withConfig({displayName:"App__Header",componentId:"n063fb-1"})(["z-index:",";"," ",""],k.header,T(u,"100%"),C("fixed",0,0,null,0)),l=f.find(t=>t.default),U=f.reduce((t,r)=>(r.children?t.push(...r.children):t.push(r),t),[]),V=()=>(s(()=>(p.start(),()=>{p.done()}),[]),null),W=()=>{const t=y();return s(()=>{window._hmt.push(["_trackPageview",E+t.pathname])},[t.pathname]),null},K=()=>{var t;const{t:r,i18n:o}=O("errors"),_=b(()=>o.language?o.dir(o.language):"",[o]),m=M(),a=w(n=>m(L.theme.setTheme(n.matches?"dark":"light")),[m]);return s(()=>{if(!N)return c.addEventListener("change",a),()=>{c.removeEventListener("change",a)}},[a]),e.createElement("div",{className:"app"},e.createElement(P,{defaultTitle:"VisualDL",titleTemplate:"%s - VisualDL"},e.createElement("html",{lang:o.language,dir:_})),e.createElement(B,{value:{fetcher:H,revalidateOnFocus:!1,revalidateOnReconnect:!1}},e.createElement(z,null,e.createElement(R,{basename:E||"/"},e.createElement(W,null),e.createElement(D,null,e.createElement(S,null)),e.createElement(A,{fallback:e.createElement(d,null)},e.createElement(j,{fallback:e.createElement(V,null)},e.createElement(x,null,e.createElement(v,{exact:!0,from:"/",to:(t=l==null?void 0:l.path)!==null&&t!==void 0?t:"/index"}),U.map(n=>e.createElement(i,{key:n.id,path:n.path,component:n.component})),e.createElement(i,{path:"*"},e.createElement(d,{title:r("errors:page-not-found")}))))))),e.createElement(I,null)))};export default K;
