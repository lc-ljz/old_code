import{r as m}from"./common/index-378ae6ec.js";import"./common/_commonjsHelpers-4f955397.js";var se=Object.prototype.hasOwnProperty;function Q(i,n){var e,f;if(i===n)return!0;if(i&&n&&(e=i.constructor)===n.constructor){if(e===Date)return i.getTime()===n.getTime();if(e===RegExp)return i.toString()===n.toString();if(e===Array){if((f=i.length)===n.length)for(;f--&&Q(i[f],n[f]););return f===-1}if(!e||typeof i=="object"){f=0;for(e in i)if(se.call(i,e)&&++f&&!se.call(n,e)||!(e in n)||!Q(i[e],n[e]))return!1;return Object.keys(n).length===f}}return i!==i&&n!==n}var X=new WeakMap,le=0;function ge(i){if(!i.length)return"";for(var n="arg",e=0;e<i.length;++e){if(i[e]===null){n+="@null";continue}var f=void 0;typeof i[e]!="object"&&typeof i[e]!="function"?typeof i[e]=="string"?f='"'+i[e]+'"':f=String(i[e]):X.has(i[e])?f=X.get(i[e]):(f=le,X.set(i[e],le++)),n+="@"+f}return n}var pe=function(){function i(n){n===void 0&&(n={}),this.__cache=new Map(Object.entries(n)),this.__listeners=[]}return i.prototype.get=function(n){var e=this.serializeKey(n)[0];return this.__cache.get(e)},i.prototype.set=function(n,e){var f=this.serializeKey(n)[0];this.__cache.set(f,e),this.notify()},i.prototype.keys=function(){return Array.from(this.__cache.keys())},i.prototype.has=function(n){var e=this.serializeKey(n)[0];return this.__cache.has(e)},i.prototype.clear=function(){this.__cache.clear(),this.notify()},i.prototype.delete=function(n){var e=this.serializeKey(n)[0];this.__cache.delete(e),this.notify()},i.prototype.serializeKey=function(n){var e=null;if(typeof n=="function")try{n=n()}catch(r){n=""}Array.isArray(n)?(e=n,n=ge(n)):n=String(n||"");var f=n?"err@"+n:"",u=n?"validating@"+n:"";return[n,e,f,u]},i.prototype.subscribe=function(n){var e=this;if(typeof n!="function")throw new Error("Expected the listener to be a function.");var f=!0;return this.__listeners.push(n),function(){if(!!f){f=!1;var u=e.__listeners.indexOf(n);u>-1&&(e.__listeners[u]=e.__listeners[e.__listeners.length-1],e.__listeners.length--)}}},i.prototype.notify=function(){for(var n=0,e=this.__listeners;n<e.length;n++){var f=e[n];f()}},i}();function me(){return typeof navigator.onLine!="undefined"?navigator.onLine:!0}function be(){return typeof document!="undefined"&&typeof document.visibilityState!="undefined"?document.visibilityState!=="hidden":!0}var we=function(i){return fetch(i).then(function(n){return n.json()})},Y={isOnline:me,isDocumentVisible:be,fetcher:we},h=new pe;function Oe(i,n,e,f,u){if(!!e.isDocumentVisible()&&!(typeof e.errorRetryCount=="number"&&u.retryCount>e.errorRetryCount)){var r=Math.min(u.retryCount||0,8),s=~~((Math.random()+.5)*(1<<r))*e.errorRetryInterval;setTimeout(f,s,u)}}var de=typeof window!="undefined"&&navigator.connection&&["slow-2g","2g"].indexOf(navigator.connection.effectiveType)!==-1,Z={onLoadingSlow:function(){},onSuccess:function(){},onError:function(){},onErrorRetry:Oe,errorRetryInterval:(de?10:5)*1e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:(de?5:3)*1e3,refreshInterval:0,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshWhenHidden:!1,refreshWhenOffline:!1,shouldRetryOnError:!0,suspense:!1,compare:Q,fetcher:Y.fetcher,isOnline:Y.isOnline,isDocumentVisible:Y.isDocumentVisible,isPaused:function(){return!1}},$=m.createContext({});$.displayName="SWRConfigContext";var ee=function(i,n,e,f){function u(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function a(c){try{t(f.next(c))}catch(d){s(d)}}function y(c){try{t(f.throw(c))}catch(d){s(d)}}function t(c){c.done?r(c.value):u(c.value).then(a,y)}t((f=f.apply(i,n||[])).next())})},re=function(i,n){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},f,u,r,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(c){return y([t,c])}}function y(t){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,u&&(r=t[0]&2?u.return:t[0]?u.throw||((r=u.return)&&r.call(u),0):u.next)&&!(r=r.call(u,t[1])).done)return r;switch(u=0,r&&(t=[t[0]&2,r.value]),t[0]){case 0:case 1:r=t;break;case 4:return e.label++,{value:t[1],done:!1};case 5:e.label++,u=t[1],t=[0];continue;case 7:t=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(t[0]===6||t[0]===2)){e=0;continue}if(t[0]===3&&(!r||t[1]>r[0]&&t[1]<r[3])){e.label=t[1];break}if(t[0]===6&&e.label<r[1]){e.label=r[1],r=t;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(t);break}r[2]&&e.ops.pop(),e.trys.pop();continue}t=n.call(i,e)}catch(c){t=[6,c],u=0}finally{f=r=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}},ne=typeof window=="undefined"||!!(typeof Deno!="undefined"&&Deno&&Deno.version&&Deno.version.deno),Re=ne?null:window.requestAnimationFrame||function(i){return setTimeout(i,1)},te=ne?m.useEffect:m.useLayoutEffect,w={},I={},U={},ie={},K={},W={},F={},ue=function(){var i=0;return function(){return++i}}();if(!ne&&window.addEventListener){var fe=function(i){if(!(!Z.isDocumentVisible()||!Z.isOnline()))for(var n in i)i[n][0]&&i[n][0]()};window.addEventListener("visibilitychange",function(){return fe(U)},!1),window.addEventListener("focus",function(){return fe(U)},!1),window.addEventListener("online",function(){return fe(ie)},!1)}var Se=function(i,n){n===void 0&&(n=!0);var e=h.serializeKey(i),f=e[0],u=e[2],r=e[3];if(!f)return Promise.resolve();var s=K[f];if(f&&s){for(var a=h.get(f),y=h.get(u),t=h.get(r),c=[],d=0;d<s.length;++d)c.push(s[d](n,a,y,t,d>0));return Promise.all(c).then(function(){return h.get(f)})}return Promise.resolve(h.get(f))},ae=function(i,n,e,f){var u=K[i];if(i&&u)for(var r=0;r<u.length;++r)u[r](!1,n,e,f)},_e=function(i,n,e){return e===void 0&&(e=!0),ee(void 0,void 0,void 0,function(){var f,u,r,s,a,y,t,c,d,j,T,V,x;return re(this,function(b){switch(b.label){case 0:if(f=h.serializeKey(i),u=f[0],r=f[2],!u)return[2];if(typeof n=="undefined")return[2,Se(i,e)];if(W[u]=ue()-1,F[u]=0,s=W[u],a=I[u],c=!1,n&&typeof n=="function")try{n=n(h.get(u))}catch(p){t=p}if(!(n&&typeof n.then=="function"))return[3,5];c=!0,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,n];case 2:return y=b.sent(),[3,4];case 3:return d=b.sent(),t=d,[3,4];case 4:return[3,6];case 5:y=n,b.label=6;case 6:return j=function(){if(s!==W[u]||a!==I[u]){if(t)throw t;return!0}},j()?[2,y]:(typeof y!="undefined"&&h.set(u,y),h.set(r,t),F[u]=ue()-1,c?[3,8]:[4,0]);case 7:if(b.sent(),j())return[2,y];b.label=8;case 8:if(T=K[u],T){for(V=[],x=0;x<T.length;++x)V.push(T[x](!!e,y,t,void 0,x>0));return[2,Promise.all(V).then(function(){if(t)throw t;return h.get(u)})]}if(t)throw t;return[2,y]}})})};function Te(){for(var i=this,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var f,u,r={};n.length>=1&&(f=n[0]),n.length>2?(u=n[1],r=n[2]):typeof n[1]=="function"?u=n[1]:typeof n[1]=="object"&&(r=n[1]);var s=h.serializeKey(f),a=s[0],y=s[1],t=s[2],c=s[3];r=Object.assign({},Z,m.useContext($),r);var d=m.useRef(r);te(function(){d.current=r}),typeof u=="undefined"&&(u=r.fetcher);var j=function(){var o=h.get(a);return typeof o=="undefined"?r.initialData:o},T=j(),V=h.get(t),x=!!h.get(c),b=m.useRef({data:!1,error:!1,isValidating:!1}),p=m.useRef({data:T,error:V,isValidating:x});m.useDebugValue(p.current.data);var he=m.useState(null)[1],C=m.useCallback(function(o){var v=!1;for(var l in o)p.current[l]!==o[l]&&(p.current[l]=o[l],b.current[l]&&(v=!0));if(v||r.suspense){if(P.current||!H.current)return;he({})}},[]),P=m.useRef(!1),L=m.useRef(a),H=m.useRef(!1),N=m.useRef({emit:function(o){for(var v,l=[],g=1;g<arguments.length;g++)l[g-1]=arguments[g];P.current||!H.current||(v=d.current)[o].apply(v,l)}}),oe=m.useCallback(function(o,v){return _e(L.current,o,v)},[]),q=function(o,v){!v||(o[a]?o[a].push(v):o[a]=[v])},G=function(o,v){if(o[a]){var l=o[a],g=l.indexOf(v);g>=0&&(l[g]=l[l.length-1],l.pop())}},R=m.useCallback(function(o){return o===void 0&&(o={}),ee(i,void 0,void 0,function(){var v,l,g,_,E,S,M;return re(this,function(O){switch(O.label){case 0:if(!a||!u)return[2,!1];if(P.current)return[2,!1];if(r.isPaused())return[2,!1];o=Object.assign({dedupe:!1},o),v=!0,l=typeof w[a]!="undefined"&&o.dedupe,O.label=1;case 1:return O.trys.push([1,6,,7]),C({isValidating:!0}),h.set(c,!0),l||ae(a,p.current.data,p.current.error,!0),g=void 0,_=void 0,l?(_=I[a],[4,w[a]]):[3,3];case 2:return g=O.sent(),[3,5];case 3:return r.loadingTimeout&&!h.get(a)&&setTimeout(function(){v&&N.current.emit("onLoadingSlow",a,r)},r.loadingTimeout),y!==null?w[a]=u.apply(void 0,y):w[a]=u(a),I[a]=_=ue(),[4,w[a]];case 4:g=O.sent(),setTimeout(function(){delete w[a],delete I[a]},r.dedupingInterval),N.current.emit("onSuccess",g,a,r),O.label=5;case 5:return I[a]>_?[2,!1]:W[a]&&(_<=W[a]||_<=F[a]||F[a]===0)?(C({isValidating:!1}),[2,!1]):(h.set(a,g),h.set(t,void 0),h.set(c,!1),E={isValidating:!1},typeof p.current.error!="undefined"&&(E.error=void 0),r.compare(p.current.data,g)||(E.data=g),C(E),l||ae(a,g,E.error,!1),[3,7]);case 6:return S=O.sent(),delete w[a],delete I[a],r.isPaused()?(C({isValidating:!1}),[2,!1]):(h.set(t,S),p.current.error!==S&&(C({isValidating:!1,error:S}),l||ae(a,void 0,S,!1)),N.current.emit("onError",S,a,r),r.shouldRetryOnError&&(M=(o.retryCount||0)+1,N.current.emit("onErrorRetry",S,a,r,R,Object.assign({dedupe:!0},o,{retryCount:M}))),[3,7]);case 7:return v=!1,[2,!0]}})})},[a]);te(function(){if(!!a){P.current=!1,H.current=!0;var o=p.current.data,v=j();L.current!==a&&(L.current=a),r.compare(o,v)||C({data:v});var l=function(){return R({dedupe:!0})};(r.revalidateOnMount||!r.initialData&&r.revalidateOnMount===void 0)&&(typeof v!="undefined"?Re(l):l());var g=!1,_=function(){g||!d.current.revalidateOnFocus||(g=!0,l(),setTimeout(function(){return g=!1},d.current.focusThrottleInterval))},E=function(){d.current.revalidateOnReconnect&&l()},S=function(M,O,ce,B,J){M===void 0&&(M=!0),J===void 0&&(J=!0);var k={},z=!1;return typeof O!="undefined"&&!r.compare(p.current.data,O)&&(k.data=O,z=!0),p.current.error!==ce&&(k.error=ce,z=!0),typeof B!="undefined"&&p.current.isValidating!==B&&(k.isValidating=B,z=!0),z&&C(k),M?J?l():R():!1};return q(U,_),q(ie,E),q(K,S),function(){C=function(){return null},P.current=!0,G(U,_),G(ie,E),G(K,S)}}},[a,R]),te(function(){var o=null,v=function(){return ee(i,void 0,void 0,function(){return re(this,function(l){switch(l.label){case 0:return!p.current.error&&(d.current.refreshWhenHidden||d.current.isDocumentVisible())&&(d.current.refreshWhenOffline||d.current.isOnline())?[4,R({dedupe:!0})]:[3,2];case 1:l.sent(),l.label=2;case 2:return d.current.refreshInterval&&o&&(o=setTimeout(v,d.current.refreshInterval)),[2]}})})};return d.current.refreshInterval&&(o=setTimeout(v,d.current.refreshInterval)),function(){o&&(clearTimeout(o),o=null)}},[r.refreshInterval,r.refreshWhenHidden,r.refreshWhenOffline,R]);var ye=m.useMemo(function(){var o={revalidate:R,mutate:oe};return Object.defineProperties(o,{error:{get:function(){return b.current.error=!0,L.current===a?p.current.error:V},enumerable:!0},data:{get:function(){return b.current.data=!0,L.current===a?p.current.data:T},enumerable:!0},isValidating:{get:function(){return b.current.isValidating=!0,a?p.current.isValidating:!1},enumerable:!0}}),o},[R]);if(r.suspense){var A=h.get(a),D=h.get(t);if(typeof A=="undefined"&&(A=T),typeof D=="undefined"&&(D=V),typeof A=="undefined"&&typeof D=="undefined"){if(w[a]||R(),w[a]&&typeof w[a].then=="function")throw w[a];A=w[a]}if(typeof A=="undefined"&&D)throw D;return{error:D,data:A,revalidate:R,mutate:oe,isValidating:p.current.isValidating}}return ye}var Ce=$.Provider,ve=function(){return ve=Object.assign||function(i){for(var n,e=1,f=arguments.length;e<f;e++){n=arguments[e];for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&(i[u]=n[u])}return i},ve.apply(this,arguments)};export default Te;export{Ce as SWRConfig,h as cache};
